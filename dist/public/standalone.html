<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burble - Brain Teasers & Riddles Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
            text-decoration: none;
            cursor: pointer;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-btn:hover,
        .nav-btn.active {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        /* Game Container */
        .game-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            min-height: 600px;
        }

        /* Home Page Styles */
        .hero-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 30px;
        }

        .user-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .game-card {
            background: #f8f9ff;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .game-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .game-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .game-description {
            color: #666;
            line-height: 1.5;
        }

        /* Common Game Styles */
        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-title-main {
            font-size: 2.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .difficulty-selector,
        .category-selector {
            margin-bottom: 20px;
            text-align: center;
        }

        .selector-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: block;
        }

        .selector-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .selector-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .selector-btn:hover,
        .selector-btn.active {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .game-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .info-card {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            text-align: center;
        }

        .info-label {
            font-size: 0.8rem;
            color: #64748b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-top: 5px;
        }

        /* Input and Button Styles */
        .input-section {
            margin-bottom: 20px;
        }

        .game-input {
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            text-align: center;
            font-weight: 600;
            transition: border-color 0.3s ease;
        }

        .game-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            min-width: 120px;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border: 2px solid #e2e8f0;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #e2e8f0;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Feedback and Display Styles */
        .game-display {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            letter-spacing: 0.3em;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .emoji-display {
            font-size: 3rem;
            line-height: 1.2;
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 12px;
            font-weight: 600;
        }

        .feedback.correct {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #10b981;
        }

        .feedback.incorrect {
            background: #fef2f2;
            color: #991b1b;
            border: 2px solid #ef4444;
        }

        .feedback.hint {
            background: #fef3c7;
            color: #92400e;
            border: 2px solid #f59e0b;
        }

        .feedback.info {
            background: #dbeafe;
            color: #1e40af;
            border: 2px solid #3b82f6;
        }

        .game-over {
            margin-top: 30px;
            padding: 30px;
            background: #f8f9ff;
            border-radius: 16px;
            border: 2px solid #e2e8f0;
            text-align: center;
        }

        .game-over.win {
            background: #d1fae5;
            border-color: #10b981;
        }

        .game-over.lose {
            background: #fef2f2;
            border-color: #ef4444;
        }

        /* Trivia Specific Styles */
        .trivia-question {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .trivia-options {
            display: grid;
            gap: 10px;
            margin-bottom: 20px;
        }

        .trivia-option {
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .trivia-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .trivia-option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .trivia-option.correct {
            border-color: #10b981;
            background: #d1fae5;
            color: #065f46;
        }

        .trivia-option.incorrect {
            border-color: #ef4444;
            background: #fef2f2;
            color: #991b1b;
        }

        /* Twenty Questions Styles */
        .question-history {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .question-item {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            background: white;
            border-left: 4px solid #667eea;
        }

        .question-text {
            font-weight: 600;
            color: #333;
        }

        .answer-text {
            color: #666;
            font-style: italic;
        }

        /* Timer */
        .timer {
            font-family: 'Courier New', monospace;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .game-container {
                padding: 20px;
            }

            .hero-title {
                font-size: 2rem;
            }

            .game-title-main {
                font-size: 2rem;
            }

            .game-display {
                font-size: 1.5rem;
            }

            .games-grid {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }

            .nav-buttons {
                justify-content: center;
                width: 100%;
                margin-top: 10px;
            }

            .header {
                flex-direction: column;
                text-align: center;
            }
        }

        /* Hidden class */
        .hidden {
            display: none !important;
        }

        /* Audio Page Styles */
        .audio-upload-section {
            margin: 20px 0;
        }

        .upload-area {
            border: 2px dashed #667eea;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            background: #f8f9ff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #5a67d8;
            background: #f0f2ff;
        }

        .upload-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .upload-icon {
            font-size: 3rem;
        }

        .audio-files-list {
            margin-top: 30px;
        }

        .audio-file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 10px;
            background: white;
        }

        .audio-file-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .audio-controls {
            display: flex;
            gap: 10px;
        }

        /* School Trivia Styles */
        .subject-selector, .grade-selector {
            margin: 15px 0;
        }

        .geo-mode-selector {
            margin: 15px 0;
        }

        /* Geo Guesser Styles */
        .geo-game-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .geo-map-container {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            min-height: 400px;
        }

        .geo-map {
            width: 100%;
            height: 400px;
            background: #f8f9ff;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .map-placeholder {
            font-size: 1.2rem;
            color: #667eea;
        }

        .geo-guess-panel {
            padding: 20px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            background: white;
        }

        .location-input {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .location-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
        }

        .geo-image-container {
            margin-top: 20px;
            text-align: center;
        }

        .geo-image-container img {
            max-width: 100%;
            border-radius: 8px;
        }

        .location-hint {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .geo-game-area {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .nav-btn {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo" onclick="showPage('home')">üß© Burble</div>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showPage('home')">Home</button>
                <button class="nav-btn" onclick="showPage('audio')">Audio</button>
                <button class="nav-btn" onclick="showPage('riddles')">Riddles</button>
                <button class="nav-btn" onclick="showPage('burble')">Burble</button>
                <button class="nav-btn" onclick="showPage('emoji')">Emoji</button>
                <button class="nav-btn" onclick="showPage('valentine')">Twenty Questions</button>
                <button class="nav-btn" onclick="showPage('trivia')">Trivia</button>
                <button class="nav-btn" onclick="showPage('animal-trivia')">Animals</button>
                <button class="nav-btn" onclick="showPage('school-trivia')">School</button>
                <button class="nav-btn" onclick="showPage('geo-guesser')">Geo Guesser</button>
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page" class="game-container">
            <div class="hero-section">
                <h1 class="hero-title">Brain Teasers & Riddles</h1>
                <p class="hero-subtitle">Challenge your mind with puzzles, riddles, and brain games</p>
                
                <!-- User Stats -->
                <div class="user-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="total-score">0</div>
                        <div class="stat-label">Total Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="games-played">0</div>
                        <div class="stat-label">Games Played</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="games-won">0</div>
                        <div class="stat-label">Games Won</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="win-rate">0%</div>
                        <div class="stat-label">Win Rate</div>
                    </div>
                </div>
            </div>

            <!-- Games Grid -->
            <div class="games-grid">
                <div class="game-card" onclick="showPage('riddles')">
                    <div class="game-icon">üß©</div>
                    <div class="game-title">Brain Riddles</div>
                    <div class="game-description">Classic riddles and brain teasers across all categories</div>
                </div>
                
                <div class="game-card" onclick="showPage('burble')">
                    <div class="game-icon">üìö</div>
                    <div class="game-title">Burble Word Game</div>
                    <div class="game-description">Word guessing with feedback and hints</div>
                </div>
                
                <div class="game-card" onclick="showPage('emoji')">
                    <div class="game-icon">üé®</div>
                    <div class="game-title">Emoji Guess</div>
                    <div class="game-description">Decode emoji combinations</div>
                </div>
                
                <div class="game-card" onclick="showPage('valentine')">
                    <div class="game-icon">üéØ</div>
                    <div class="game-title">Twenty Questions</div>
                    <div class="game-description">Yes/No question guessing game</div>
                </div>
                
                <div class="game-card" onclick="showPage('trivia')">
                    <div class="game-icon">üß†</div>
                    <div class="game-title">General Trivia</div>
                    <div class="game-description">Test your knowledge across various topics</div>
                </div>
                
                <div class="game-card" onclick="showPage('animal-trivia')">
                    <div class="game-icon">ü¶Å</div>
                    <div class="game-title">Animal Trivia</div>
                    <div class="game-description">Animal-focused quiz questions</div>
                </div>

                <div class="game-card" onclick="showPage('audio')">
                    <div class="game-icon">üéµ</div>
                    <div class="game-title">Audio Manager</div>
                    <div class="game-description">Upload and manage your audio files</div>
                </div>

                <div class="game-card" onclick="showPage('school-trivia')">
                    <div class="game-icon">üéì</div>
                    <div class="game-title">School Trivia</div>
                    <div class="game-description">Educational questions across all subjects and grade levels</div>
                </div>

                <div class="game-card" onclick="showPage('geo-guesser')">
                    <div class="game-icon">üåç</div>
                    <div class="game-title">Geo Guesser</div>
                    <div class="game-description">Guess world locations, US states, and continents</div>
                </div>
            </div>
        </div>

        <!-- Riddles Game -->
        <div id="riddles-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üß© Brain Riddles</h1>
                
                <div class="difficulty-selector">
                    <span class="selector-label">Difficulty</span>
                    <div class="selector-buttons">
                        <button class="selector-btn" data-difficulty="easy">Easy</button>
                        <button class="selector-btn active" data-difficulty="medium">Medium</button>
                        <button class="selector-btn" data-difficulty="hard">Hard</button>
                    </div>
                </div>

                <div class="category-selector">
                    <span class="selector-label">Category</span>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-category="all">All Types</button>
                        <button class="selector-btn" data-category="logic">Logic</button>
                        <button class="selector-btn" data-category="word">Word</button>
                        <button class="selector-btn" data-category="math">Math</button>
                        <button class="selector-btn" data-category="lateral">Lateral Thinking</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="riddles-score">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Solved</div>
                    <div class="info-value" id="riddles-solved">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Category</div>
                    <div class="info-value" id="riddles-category">All Types</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Difficulty</div>
                    <div class="info-value" id="riddles-difficulty">Medium</div>
                </div>
            </div>

            <div id="riddles-question-container">
                <div class="game-display" id="riddles-question">Click "New Riddle" to start solving brain teasers!</div>
            </div>

            <div class="input-section">
                <input type="text" class="game-input" id="riddles-input" placeholder="Type your answer..." disabled>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="riddles-submit" disabled>Submit Answer</button>
                <button class="btn btn-secondary" id="riddles-hint" disabled>Get Hint (-10 points)</button>
                <button class="btn btn-secondary" id="riddles-next">New Riddle</button>
            </div>

            <div id="riddles-feedback"></div>
            <div id="riddles-game-over"></div>
        </div>

        <!-- Burble Word Game -->
        <div id="burble-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üß© Burble Word Game</h1>
                
                <div class="difficulty-selector">
                    <span class="selector-label">Difficulty</span>
                    <div class="selector-buttons">
                        <button class="selector-btn" data-difficulty="easy">Easy (15 attempts)</button>
                        <button class="selector-btn active" data-difficulty="medium">Medium (10 attempts)</button>
                        <button class="selector-btn" data-difficulty="hard">Hard (5 attempts)</button>
                    </div>
                </div>

                <div class="category-selector">
                    <span class="selector-label">Category</span>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-category="Food">Food</button>
                        <button class="selector-btn" data-category="Animals">Animals</button>
                        <button class="selector-btn" data-category="Colors">Colors</button>
                        <button class="selector-btn" data-category="Cities">Cities</button>
                        <button class="selector-btn" data-category="Items">Items</button>
                        <button class="selector-btn" data-category="Sports">Sports</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Attempts</div>
                    <div class="info-value" id="burble-attempts">0/10</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Category</div>
                    <div class="info-value" id="burble-category">Food</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Time</div>
                    <div class="info-value timer" id="burble-timer">00:00</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="burble-score">0</div>
                </div>
            </div>

            <div class="game-display" id="burble-display">Click "New Game" to start!</div>

            <div class="input-section">
                <input type="text" class="game-input" id="burble-input" placeholder="Enter your guess..." maxlength="20" disabled>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="burble-submit" disabled>Submit Guess</button>
                <button class="btn btn-secondary" id="burble-hint" disabled>Get Hint</button>
                <button class="btn btn-secondary" id="burble-new-game">New Game</button>
            </div>

            <div id="burble-feedback"></div>
            <div id="burble-game-over"></div>
        </div>

        <!-- Emoji Guess Game -->
        <div id="emoji-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üß© Emoji Guess</h1>
                
                <div class="difficulty-selector">
                    <span class="selector-label">Difficulty</span>
                    <div class="selector-buttons">
                        <button class="selector-btn" data-difficulty="easy">Easy</button>
                        <button class="selector-btn active" data-difficulty="medium">Medium</button>
                        <button class="selector-btn" data-difficulty="hard">Hard</button>
                    </div>
                </div>

                <div class="category-selector">
                    <span class="selector-label">Category</span>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-category="all">All</button>
                        <button class="selector-btn" data-category="movies">Movies</button>
                        <button class="selector-btn" data-category="foods">Foods</button>
                        <button class="selector-btn" data-category="animals">Animals</button>
                        <button class="selector-btn" data-category="items">Items</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="emoji-score">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Hints Used</div>
                    <div class="info-value" id="emoji-hints">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Category</div>
                    <div class="info-value" id="emoji-category">All</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Difficulty</div>
                    <div class="info-value" id="emoji-difficulty">Medium</div>
                </div>
            </div>

            <div class="game-display emoji-display" id="emoji-display">Click "New Puzzle" to start!</div>

            <div class="input-section">
                <input type="text" class="game-input" id="emoji-input" placeholder="What does this emoji combination represent?" disabled>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="emoji-submit" disabled>Submit Answer</button>
                <button class="btn btn-secondary" id="emoji-hint" disabled>Get Hint (-5 points)</button>
                <button class="btn btn-secondary" id="emoji-new-puzzle">New Puzzle</button>
            </div>

            <div id="emoji-feedback"></div>
            <div id="emoji-game-over"></div>
        </div>

        <!-- Twenty Questions Game -->
        <div id="valentine-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üéØ Twenty Questions</h1>
                
                <div class="difficulty-selector">
                    <span class="selector-label">Difficulty</span>
                    <div class="selector-buttons">
                        <button class="selector-btn" data-difficulty="easy">Easy (8 questions)</button>
                        <button class="selector-btn active" data-difficulty="medium">Medium (6 questions)</button>
                        <button class="selector-btn" data-difficulty="hard">Hard (4 questions)</button>
                    </div>
                </div>

                <div class="category-selector">
                    <span class="selector-label">Category</span>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-category="movies">Movies</button>
                        <button class="selector-btn" data-category="animals">Animals</button>
                        <button class="selector-btn" data-category="places">Places</button>
                        <button class="selector-btn" data-category="objects">Objects</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Questions Left</div>
                    <div class="info-value" id="valentine-questions">6</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Guesses Left</div>
                    <div class="info-value" id="valentine-guesses">3</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Category</div>
                    <div class="info-value" id="valentine-category">Movies</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="valentine-score">0</div>
                </div>
            </div>

            <div class="question-history" id="valentine-history">
                <p style="text-align: center; color: #666;">Ask yes/no questions to figure out what I'm thinking of!</p>
            </div>

            <div class="input-section">
                <input type="text" class="game-input" id="valentine-question" placeholder="Ask a yes/no question..." disabled>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="valentine-ask" disabled>Ask Question</button>
                <button class="btn btn-secondary" id="valentine-guess" disabled>Make Guess</button>
                <button class="btn btn-secondary" id="valentine-new-game">New Game</button>
            </div>

            <div id="valentine-feedback"></div>
            <div id="valentine-game-over"></div>
        </div>

        <!-- General Trivia Game -->
        <div id="trivia-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üß† General Trivia</h1>
                
                <div class="difficulty-selector">
                    <span class="selector-label">Difficulty</span>
                    <div class="selector-buttons">
                        <button class="selector-btn" data-difficulty="easy">Easy</button>
                        <button class="selector-btn active" data-difficulty="medium">Medium</button>
                        <button class="selector-btn" data-difficulty="hard">Hard</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Question</div>
                    <div class="info-value" id="trivia-question-num">0/10</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Correct</div>
                    <div class="info-value" id="trivia-correct">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="trivia-score">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Time</div>
                    <div class="info-value timer" id="trivia-timer">00:00</div>
                </div>
            </div>

            <div class="trivia-question" id="trivia-question-text">Click "Start Quiz" to begin!</div>

            <div class="trivia-options" id="trivia-options"></div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="trivia-submit" disabled>Submit Answer</button>
                <button class="btn btn-secondary" id="trivia-next" disabled>Next Question</button>
                <button class="btn btn-secondary" id="trivia-start">Start Quiz</button>
            </div>

            <div id="trivia-feedback"></div>
            <div id="trivia-game-over"></div>
        </div>

        <!-- Animal Trivia Game -->
        <div id="animal-trivia-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">ü¶Å Animal Trivia</h1>
                
                <div class="difficulty-selector">
                    <span class="selector-label">Difficulty</span>
                    <div class="selector-buttons">
                        <button class="selector-btn" data-difficulty="easy">Easy</button>
                        <button class="selector-btn active" data-difficulty="medium">Medium</button>
                        <button class="selector-btn" data-difficulty="hard">Hard</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Question</div>
                    <div class="info-value" id="animal-question-num">0/15</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Correct</div>
                    <div class="info-value" id="animal-correct">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="animal-score">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Time</div>
                    <div class="info-value timer" id="animal-timer">00:00</div>
                </div>
            </div>

            <div class="trivia-question" id="animal-question-text">Click "Start Quiz" to begin!</div>

            <div class="trivia-options" id="animal-options"></div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="animal-submit" disabled>Submit Answer</button>
                <button class="btn btn-secondary" id="animal-next" disabled>Next Question</button>
                <button class="btn btn-secondary" id="animal-start">Start Quiz</button>
            </div>

            <div id="animal-feedback"></div>
            <div id="animal-game-over"></div>
        </div>

        <!-- Audio Page -->
        <div id="audio-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üéµ Audio Manager</h1>
                <p>Upload and manage your audio files</p>
            </div>

            <div class="audio-upload-section">
                <div class="upload-area">
                    <input type="file" id="audio-file-input" accept="audio/*" multiple style="display: none;">
                    <div class="upload-placeholder" onclick="document.getElementById('audio-file-input').click();">
                        <div class="upload-icon">üìÅ</div>
                        <div>Click to upload audio files</div>
                        <small>MP3, WAV, OGG supported</small>
                    </div>
                </div>
            </div>

            <div class="audio-files-list">
                <h3>Your Audio Files</h3>
                <div id="audio-files-container">
                    <p class="no-files">No audio files uploaded yet.</p>
                </div>
            </div>
        </div>

        <!-- School Trivia Page -->
        <div id="school-trivia-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üéì School Trivia</h1>
                
                <div class="subject-selector">
                    <span class="selector-label">Subject</span>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-subject="math">Math</button>
                        <button class="selector-btn" data-subject="science">Science</button>
                        <button class="selector-btn" data-subject="english">English</button>
                        <button class="selector-btn" data-subject="history">History</button>
                    </div>
                </div>

                <div class="grade-selector">
                    <span class="selector-label">Grade Level</span>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-grade="elementary">K-4th Grade</button>
                        <button class="selector-btn" data-grade="middle">5th-8th Grade</button>
                        <button class="selector-btn" data-grade="high">High School</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Question</div>
                    <div class="info-value" id="school-question-num">0/10</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Subject</div>
                    <div class="info-value" id="school-subject">Math</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Grade</div>
                    <div class="info-value" id="school-grade">K-4th</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="school-score">0</div>
                </div>
            </div>

            <div class="trivia-question" id="school-question-text">Select subject and grade level, then start!</div>
            <div class="trivia-options" id="school-options"></div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="school-submit" disabled>Submit Answer</button>
                <button class="btn btn-secondary" id="school-next" disabled>Next Question</button>
                <button class="btn btn-secondary" id="school-start">Start Quiz</button>
            </div>

            <div id="school-feedback"></div>
            <div id="school-game-over"></div>
        </div>

        <!-- Geo Guesser Page -->
        <div id="geo-guesser-page" class="game-container hidden">
            <div class="game-header">
                <h1 class="game-title-main">üåç Geo Guesser</h1>
                
                <div class="geo-mode-selector">
                    <span class="selector-label">Game Mode</span>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-mode="world">World Locations</button>
                        <button class="selector-btn" data-mode="us-states">US States</button>
                        <button class="selector-btn" data-mode="continents">Continents</button>
                    </div>
                </div>
            </div>

            <div class="game-info">
                <div class="info-card">
                    <div class="info-label">Round</div>
                    <div class="info-value" id="geo-round">1/5</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Score</div>
                    <div class="info-value" id="geo-score">0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Distance</div>
                    <div class="info-value" id="geo-distance">-</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Accuracy</div>
                    <div class="info-value" id="geo-accuracy">-</div>
                </div>
            </div>

            <div class="geo-game-area">
                <div class="geo-map-container">
                    <div id="geo-map" class="geo-map">
                        <div class="map-placeholder">üó∫Ô∏è Interactive Map Will Load Here</div>
                    </div>
                </div>

                <div class="geo-guess-panel">
                    <h3>Where do you think this is?</h3>
                    <div class="location-input">
                        <input type="text" id="geo-guess-input" placeholder="Enter your guess..." />
                        <button class="btn btn-primary" id="geo-submit-guess">Submit Guess</button>
                    </div>
                    
                    <div class="geo-image-container">
                        <img id="geo-location-image" src="" alt="Location to guess" style="display: none;">
                        <div id="geo-location-hint" class="location-hint"></div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" id="geo-start">Start Game</button>
                <button class="btn btn-secondary" id="geo-next" disabled>Next Location</button>
                <button class="btn btn-secondary" id="geo-skip">Skip Location</button>
            </div>

            <div id="geo-feedback"></div>
            <div id="geo-game-over"></div>
        </div>
    </div>

    <script>
        // Global game state
        const gameState = {
            currentPage: 'home',
            userStats: {
                totalScore: 0,
                gamesPlayed: 0,
                gamesWon: 0
            },
            burble: {
                difficulty: 'medium',
                category: 'Food',
                currentWord: '',
                attempts: 0,
                maxAttempts: 10,
                score: 0,
                gameActive: false,
                startTime: null,
                timerInterval: null,
                hintsUsed: 0
            },
            emoji: {
                difficulty: 'medium',
                category: 'all',
                currentPuzzle: null,
                score: 0,
                hintsUsed: 0,
                gameActive: false
            },
            valentine: {
                difficulty: 'medium',
                category: 'movies',
                currentAnswer: '',
                questionsLeft: 6,
                guessesLeft: 3,
                score: 0,
                gameActive: false,
                questions: [],
                answers: []
            },
            trivia: {
                difficulty: 'medium',
                currentQuestion: 0,
                totalQuestions: 10,
                correctAnswers: 0,
                score: 0,
                gameActive: false,
                startTime: null,
                timerInterval: null,
                selectedAnswer: null
            },
            animalTrivia: {
                difficulty: 'medium',
                currentQuestion: 0,
                totalQuestions: 15,
                correctAnswers: 0,
                score: 0,
                gameActive: false,
                startTime: null,
                timerInterval: null,
                selectedAnswer: null
            },
            riddles: {
                difficulty: 'medium',
                category: 'all',
                currentRiddle: null,
                currentHintLevel: 0,
                score: 0,
                solved: 0,
                hintsUsed: 0,
                gameActive: false,
                attemptCount: 0,
                maxAttempts: 3
            },
            audio: {
                files: [],
                currentFile: null,
                isPlaying: false
            },
            schoolTrivia: {
                subject: 'math',
                grade: 'elementary',
                currentQuestion: 0,
                totalQuestions: 10,
                correctAnswers: 0,
                score: 0,
                gameActive: false,
                selectedAnswer: null
            },
            geoGuesser: {
                mode: 'world',
                currentRound: 0,
                totalRounds: 5,
                score: 0,
                gameActive: false,
                currentLocation: null,
                guessedLocation: null,
                distance: 0,
                accuracy: 0
            }
        };

        // Word categories for Burble game
        const wordCategories = {
            Food: {
                4: ['cake', 'taco', 'rice', 'soup', 'bean', 'fish', 'pear', 'plum'],
                5: ['pizza', 'apple', 'salad', 'pasta', 'fruit', 'onion', 'bread', 'steak'],
                6: ['burger', 'cheese', 'cookie', 'banana', 'orange', 'tomato', 'potato'],
                7: ['avocado', 'chicken', 'pancake', 'almond', 'noodles', 'sausage'],
                8: ['broccoli', 'mushroom', 'sandwich', 'blueberry', 'eggplant', 'pineapple']
            },
            Animals: {
                4: ['frog', 'wolf', 'bear', 'deer', 'bird', 'fish', 'lion', 'duck'],
                5: ['tiger', 'sheep', 'snake', 'mouse', 'panda', 'koala', 'horse'],
                6: ['turtle', 'giraffe', 'monkey', 'beaver', 'weasel', 'rabbit'],
                7: ['dolphin', 'penguin', 'octopus', 'raccoon', 'leopard', 'buffalo'],
                8: ['elephant', 'hedgehog', 'flamingo', 'kangaroo', 'scorpion', 'crocodile']
            },
            Colors: {
                4: ['blue', 'pink', 'gold', 'gray', 'teal', 'cyan'],
                5: ['green', 'brown', 'black', 'white', 'amber', 'azure'],
                6: ['purple', 'silver', 'indigo', 'maroon', 'ochre', 'orange'],
                7: ['crimson', 'magenta', 'cerulean', 'lavender', 'turquoise'],
                8: ['burgundy', 'periwinkle', 'sapphire', 'platinum', 'marigold']
            },
            Cities: {
                4: ['rome', 'oslo', 'bali', 'lima', 'york', 'lyon', 'riga', 'kiev'],
                5: ['tokyo', 'paris', 'miami', 'delhi', 'dubai', 'seoul', 'cairo'],
                6: ['london', 'berlin', 'moscow', 'madrid', 'munich', 'sydney'],
                7: ['beijing', 'chicago', 'toronto', 'atlanta', 'houston', 'phoenix'],
                8: ['shanghai', 'istanbul', 'budapest', 'montreal', 'florence', 'helsinki']
            },
            Items: {
                4: ['fork', 'lamp', 'book', 'ring', 'desk', 'mask', 'pen', 'phone', 'shoe'],
                5: ['table', 'chair', 'clock', 'brush', 'phone', 'purse', 'scarf', 'watch'],
                6: ['mirror', 'pillow', 'remote', 'candle', 'wallet', 'hammer', 'laptop'],
                7: ['charger', 'suitcase', 'backpack', 'earbuds', 'cushion', 'toaster'],
                8: ['scissors', 'notebook', 'umbrella', 'keyboard', 'television', 'bookshelf']
            },
            Sports: {
                4: ['golf', 'swim', 'bike', 'surf', 'bowl', 'judo', 'dive', 'ski'],
                5: ['chess', 'rugby', 'skate', 'climb', 'kayak', 'dance', 'jog', 'cycle'],
                6: ['soccer', 'hockey', 'tennis', 'boxing', 'rowing', 'hiking', 'racing'],
                7: ['archery', 'bowling', 'cricket', 'fencing', 'jogging', 'baseball'],
                8: ['football', 'basketball', 'wrestling', 'athletics', 'marathon', 'swimming']
            }
        };

        // Comprehensive riddles database
        const riddlesData = {
            logic: {
                easy: [
                    {
                        riddle: "What comes once in a minute, twice in a moment, but never in a thousand years?",
                        answer: "the letter m",
                        acceptedAnswers: ["m", "letter m", "the letter m"],
                        hints: [
                            "Think about the words in the riddle itself.",
                            "Look at the letters that make up each word.",
                            "Count the letter 'M' in 'minute', 'moment', and 'thousand years'."
                        ],
                        category: "logic",
                        difficulty: "easy"
                    },
                    {
                        riddle: "I'm tall when I'm young, and I'm short when I'm old. What am I?",
                        answer: "candle",
                        acceptedAnswers: ["candle", "a candle"],
                        hints: [
                            "This object changes size as it's used.",
                            "It provides light and gets shorter over time.",
                            "You light it with a match and it melts as it burns."
                        ],
                        category: "logic",
                        difficulty: "easy"
                    },
                    {
                        riddle: "What has keys but no locks, space but no room, you can enter but not go inside?",
                        answer: "keyboard",
                        acceptedAnswers: ["keyboard", "a keyboard", "computer keyboard"],
                        hints: [
                            "This is something you use with technology.",
                            "It has an 'Enter' key and a 'Space' bar.",
                            "You press its keys to type letters and numbers on a computer."
                        ],
                        category: "logic",
                        difficulty: "easy"
                    },
                    {
                        riddle: "What gets wet while drying?",
                        answer: "towel",
                        acceptedAnswers: ["towel", "a towel"],
                        hints: [
                            "This item is used in bathrooms.",
                            "It absorbs moisture from something else while becoming moist itself.",
                            "You use it after a shower to dry your body."
                        ],
                        category: "logic",
                        difficulty: "easy"
                    }
                ],
                medium: [
                    {
                        riddle: "The more you take, the more you leave behind. What am I?",
                        answer: "footsteps",
                        acceptedAnswers: ["footsteps", "steps", "footprints"],
                        hints: [
                            "This relates to movement and travel.",
                            "Every time you do this action, you create evidence of it.",
                            "When you walk, you take these and leave traces behind."
                        ],
                        category: "logic",
                        difficulty: "medium"
                    },
                    {
                        riddle: "I have cities, but no houses. I have mountains, but no trees. I have water, but no fish. What am I?",
                        answer: "map",
                        acceptedAnswers: ["map", "a map"],
                        hints: [
                            "This is a flat representation of something three-dimensional.",
                            "It shows geographical features but not living things.",
                            "You unfold this to find directions and plan routes."
                        ],
                        category: "logic",
                        difficulty: "medium"
                    },
                    {
                        riddle: "What breaks but never falls, and what falls but never breaks?",
                        answer: "day breaks and night falls",
                        acceptedAnswers: ["day and night", "day breaks night falls", "dawn and dusk"],
                        hints: [
                            "These are two opposite things that happen every day.",
                            "One happens in the morning, the other in the evening.",
                            "Think about sunrise (dawn ____) and sunset (night ____)"
                        ],
                        category: "logic",
                        difficulty: "medium"
                    },
                    {
                        riddle: "Forward I am heavy, but backward I am not. What am I?",
                        answer: "ton",
                        acceptedAnswers: ["ton", "the word ton"],
                        hints: [
                            "This is a wordplay riddle about spelling.",
                            "Think about what this word means forward vs backward.",
                            "The word 'TON' spelled backward is 'NOT'."
                        ],
                        category: "logic",
                        difficulty: "medium"
                    }
                ],
                hard: [
                    {
                        riddle: "A man lives on the twentieth floor of an apartment building. Every morning he takes the elevator down to the ground floor. When he comes home, he takes the elevator to the tenth floor and walks the rest of the way... except on rainy days, when he takes the elevator all the way to the twentieth floor. Why?",
                        answer: "he is too short to reach the button",
                        acceptedAnswers: ["he's short", "he can't reach the button", "too short", "short person", "he's too short to reach"],
                        hint: "Think about his physical limitations and what changes on rainy days.",
                        category: "logic",
                        difficulty: "hard"
                    },
                    {
                        riddle: "A woman shoots her husband, then holds him underwater for five minutes. Next, she hangs him. Right after, they enjoy a lovely dinner. How?",
                        answer: "she's a photographer",
                        acceptedAnswers: ["photographer", "she's a photographer", "photography", "developing photos"],
                        hint: "Think about a profession that involves 'shooting', 'developing', and 'hanging'.",
                        category: "logic",
                        difficulty: "hard"
                    }
                ]
            },
            word: {
                easy: [
                    {
                        riddle: "What word becomes shorter when you add two letters to it?",
                        answer: "short",
                        acceptedAnswers: ["short", "the word short"],
                        hint: "Add 'er' to the end.",
                        category: "word",
                        difficulty: "easy"
                    },
                    {
                        riddle: "What 5-letter word typed in all capital letters can be read the same upside down?",
                        answer: "swims",
                        acceptedAnswers: ["swims"],
                        hint: "When rotated 180 degrees, it looks the same.",
                        category: "word",
                        difficulty: "easy"
                    },
                    {
                        riddle: "What word is spelled wrong in the dictionary?",
                        answer: "wrong",
                        acceptedAnswers: ["wrong", "the word wrong"],
                        hint: "It's literally in the question.",
                        category: "word",
                        difficulty: "easy"
                    }
                ],
                medium: [
                    {
                        riddle: "I am a word of letters three. Add two and fewer there will be. What word am I?",
                        answer: "few",
                        acceptedAnswers: ["few", "the word few"],
                        hint: "Adding 'er' makes it mean 'less'.",
                        category: "word",
                        difficulty: "medium"
                    },
                    {
                        riddle: "What English word retains the same pronunciation, even after you take away four of its five letters?",
                        answer: "queue",
                        acceptedAnswers: ["queue"],
                        hint: "It sounds like a single letter.",
                        category: "word",
                        difficulty: "medium"
                    }
                ],
                hard: [
                    {
                        riddle: "What seven-letter word contains dozens of letters?",
                        answer: "mailbox",
                        acceptedAnswers: ["mailbox", "postbox"],
                        hint: "It contains mail, which includes letters.",
                        category: "word",
                        difficulty: "hard"
                    }
                ]
            },
            math: {
                easy: [
                    {
                        riddle: "If you multiply this number by any other number, the answer will always be the same. What number is it?",
                        answer: "zero",
                        acceptedAnswers: ["0", "zero"],
                        hint: "Anything times this equals itself.",
                        category: "math",
                        difficulty: "easy"
                    },
                    {
                        riddle: "I am an odd number. Take away a letter and I become even. What number am I?",
                        answer: "seven",
                        acceptedAnswers: ["7", "seven"],
                        hint: "Remove the 's' from the word.",
                        category: "math",
                        difficulty: "easy"
                    }
                ],
                medium: [
                    {
                        riddle: "A man has 5 sons, and each of his sons has a sister. How many children does the man have?",
                        answer: "6",
                        acceptedAnswers: ["6", "six"],
                        hint: "They all share the same sister.",
                        category: "math",
                        difficulty: "medium"
                    },
                    {
                        riddle: "If there are three apples and you take away two, how many apples do you have?",
                        answer: "2",
                        acceptedAnswers: ["2", "two"],
                        hint: "How many did YOU take?",
                        category: "math",
                        difficulty: "medium"
                    }
                ],
                hard: [
                    {
                        riddle: "A father is 4 times as old as his daughter. In 6 years, he will be 3 times as old. How old are they now?",
                        answer: "daughter is 6, father is 24",
                        acceptedAnswers: ["6 and 24", "daughter 6 father 24", "6, 24"],
                        hint: "Set up equations: F = 4D and F + 6 = 3(D + 6)",
                        category: "math",
                        difficulty: "hard"
                    }
                ]
            },
            lateral: {
                easy: [
                    {
                        riddle: "A man lives in a house where all four walls face south. A bear walks by the house. What color is the bear?",
                        answer: "white",
                        acceptedAnswers: ["white", "polar bear"],
                        hint: "Where is the only place this house could be?",
                        category: "lateral",
                        difficulty: "easy"
                    }
                ],
                medium: [
                    {
                        riddle: "A man pushed his car to a hotel and told the owner he was bankrupt. What happened?",
                        answer: "playing monopoly",
                        acceptedAnswers: ["monopoly", "board game", "playing monopoly"],
                        hint: "Think about a game with cars, hotels, and bankruptcy.",
                        category: "lateral",
                        difficulty: "medium"
                    },
                    {
                        riddle: "Romeo and Juliet are found dead on the floor in a puddle of water. There is broken glass around them. How did they die?",
                        answer: "they were fish",
                        acceptedAnswers: ["fish", "they were fish", "goldfish"],
                        hint: "They weren't human.",
                        category: "lateral",
                        difficulty: "medium"
                    }
                ],
                hard: [
                    {
                        riddle: "A man calls his dog from the opposite side of a river. The dog crosses the river without getting wet, and without using a bridge or boat. How?",
                        answer: "the river was frozen",
                        acceptedAnswers: ["frozen", "river was frozen", "ice", "winter"],
                        hint: "What state would the water be in?",
                        category: "lateral",
                        difficulty: "hard"
                    }
                ]
            }
        };

        // Function to get all riddles for a category/difficulty combination
        function getRiddlesByFilter(category, difficulty) {
            if (category === 'all') {
                const allRiddles = [];
                Object.keys(riddlesData).forEach(cat => {
                    if (riddlesData[cat][difficulty]) {
                        allRiddles.push(...riddlesData[cat][difficulty]);
                    }
                });
                return allRiddles;
            } else {
                return riddlesData[category] && riddlesData[category][difficulty] ? riddlesData[category][difficulty] : [];
            }
        }

        // Function to check if answer is correct (fuzzy matching)
        function checkRiddleAnswer(userAnswer, correctAnswers) {
            const normalized = userAnswer.toLowerCase().trim();
            return correctAnswers.some(answer => {
                const normalizedAnswer = answer.toLowerCase().trim();
                return normalized === normalizedAnswer || 
                       normalized.includes(normalizedAnswer) || 
                       normalizedAnswer.includes(normalized) ||
                       levenshteinDistance(normalized, normalizedAnswer) <= Math.max(1, Math.floor(normalizedAnswer.length * 0.2));
            });
        }

        // Simple edit distance calculation for fuzzy matching
        function levenshteinDistance(str1, str2) {
            const matrix = [];
            for (let i = 0; i <= str2.length; i++) {
                matrix[i] = [i];
            }
            for (let j = 0; j <= str1.length; j++) {
                matrix[0][j] = j;
            }
            for (let i = 1; i <= str2.length; i++) {
                for (let j = 1; j <= str1.length; j++) {
                    if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1,
                            matrix[i][j - 1] + 1,
                            matrix[i - 1][j] + 1
                        );
                    }
                }
            }
            return matrix[str2.length][str1.length];
        }

        // Emoji puzzles
        const emojiPuzzles = {
            movies: [
                { emoji: 'ü¶Åüëë', answer: 'The Lion King', hint: 'Disney movie about a young lion prince' },
                { emoji: 'üêüüîç', answer: 'Finding Nemo', hint: 'Pixar movie about a lost clownfish' },
                { emoji: '‚ùÑÔ∏èüë∏', answer: 'Frozen', hint: 'Disney movie with "Let It Go"' },
                { emoji: 'üï∑Ô∏èüë®', answer: 'Spider-Man', hint: 'Marvel superhero with web-slinging abilities' },
                { emoji: 'ü¶áüë®', answer: 'Batman', hint: 'Dark Knight of Gotham City' },
                { emoji: 'üè∞üë∏üíé', answer: 'Cinderella', hint: 'Fairy tale about a glass slipper' },
                { emoji: 'üåäüö¢üíî', answer: 'Titanic', hint: 'Epic romance on an ill-fated ship' },
                { emoji: 'üçïüè†üêÄ', answer: 'Ratatouille', hint: 'Pixar movie about a cooking rat' }
            ],
            foods: [
                { emoji: 'üçûü•úüçá', answer: 'Peanut Butter and Jelly', hint: 'Classic sandwich combination' },
                { emoji: 'üçùüßÑüåø', answer: 'Spaghetti', hint: 'Long pasta often served with sauce' },
                { emoji: 'üåÆüå∂Ô∏èü•©', answer: 'Spicy Beef Taco', hint: 'Mexican dish with seasoned meat' },
                { emoji: 'üçïüßÄüçÑ', answer: 'Mushroom Pizza', hint: 'Italian dish with fungus topping' },
                { emoji: 'ü•óü•ïü•í', answer: 'Garden Salad', hint: 'Healthy mix of vegetables' },
                { emoji: 'üçîü•ìüßÄ', answer: 'Bacon Cheeseburger', hint: 'American fast food classic' },
                { emoji: 'üç∞üçìüéÇ', answer: 'Strawberry Cake', hint: 'Sweet dessert with berries' },
                { emoji: 'ü•™ü•¨üçÖ', answer: 'BLT Sandwich', hint: 'Bacon, lettuce, and tomato' }
            ],
            animals: [
                { emoji: 'üêòüëÇüêæ', answer: 'Elephant', hint: 'Largest land mammal with big ears' },
                { emoji: 'ü¶íüìèüå≥', answer: 'Giraffe', hint: 'Tallest animal in the world' },
                { emoji: 'üêß‚ùÑÔ∏èüêü', answer: 'Penguin', hint: 'Flightless bird that loves fish' },
                { emoji: 'üê®üåøüá¶üá∫', answer: 'Koala', hint: 'Australian marsupial that eats eucalyptus' },
                { emoji: 'ü¶Åüó£Ô∏èüëë', answer: 'Lion', hint: 'King of the jungle with a mighty roar' },
                { emoji: 'üêÖüü†‚ö´', answer: 'Tiger', hint: 'Large cat with distinctive stripes' },
                { emoji: 'üêº‚ö´‚ö™', answer: 'Panda', hint: 'Black and white bear from China' },
                { emoji: 'ü¶òü•äüá¶üá∫', answer: 'Kangaroo', hint: 'Hopping marsupial from Australia' }
            ],
            items: [
                { emoji: 'üì±üìûüí¨', answer: 'Smartphone', hint: 'Modern communication device' },
                { emoji: 'üíª‚å®Ô∏èüñ±Ô∏è', answer: 'Computer', hint: 'Electronic device for work and entertainment' },
                { emoji: 'üîëüö™üè†', answer: 'House Key', hint: 'Metal object that opens doors' },
                { emoji: '‚åö‚è∞üëã', answer: 'Watch', hint: 'Timepiece worn on the wrist' },
                { emoji: 'üëìüëÅÔ∏èüìñ', answer: 'Reading Glasses', hint: 'Eyewear for better vision' },
                { emoji: 'üéßüéµüëÇ', answer: 'Headphones', hint: 'Audio device worn over ears' },
                { emoji: 'üì∑üì∏üñºÔ∏è', answer: 'Camera', hint: 'Device for taking pictures' },
                { emoji: '‚òÇÔ∏è‚òîüåßÔ∏è', answer: 'Umbrella', hint: 'Protection from rain and sun' }
            ]
        };

        // Twenty Questions answers by category
        const valentineAnswers = {
            movies: [
                { answer: 'Avatar', category: 'Movies' },
                { answer: 'Titanic', category: 'Movies' },
                { answer: 'Star Wars', category: 'Movies' },
                { answer: 'The Lion King', category: 'Movies' },
                { answer: 'Jurassic Park', category: 'Movies' },
                { answer: 'Finding Nemo', category: 'Movies' },
                { answer: 'Frozen', category: 'Movies' },
                { answer: 'The Avengers', category: 'Movies' }
            ],
            animals: [
                { answer: 'Elephant', category: 'Animals' },
                { answer: 'Giraffe', category: 'Animals' },
                { answer: 'Penguin', category: 'Animals' },
                { answer: 'Lion', category: 'Animals' },
                { answer: 'Dolphin', category: 'Animals' },
                { answer: 'Koala', category: 'Animals' },
                { answer: 'Tiger', category: 'Animals' },
                { answer: 'Kangaroo', category: 'Animals' }
            ],
            places: [
                { answer: 'Paris', category: 'Places' },
                { answer: 'Tokyo', category: 'Places' },
                { answer: 'New York', category: 'Places' },
                { answer: 'London', category: 'Places' },
                { answer: 'Sydney', category: 'Places' },
                { answer: 'Rome', category: 'Places' },
                { answer: 'Cairo', category: 'Places' },
                { answer: 'Dubai', category: 'Places' }
            ],
            objects: [
                { answer: 'Smartphone', category: 'Objects' },
                { answer: 'Television', category: 'Objects' },
                { answer: 'Bicycle', category: 'Objects' },
                { answer: 'Piano', category: 'Objects' },
                { answer: 'Camera', category: 'Objects' },
                { answer: 'Umbrella', category: 'Objects' },
                { answer: 'Guitar', category: 'Objects' },
                { answer: 'Laptop', category: 'Objects' }
            ]
        };

        // Trivia questions
        const triviaQuestions = {
            easy: [
                { question: "What is the capital of France?", options: ["London", "Berlin", "Paris", "Madrid"], correct: 2 },
                { question: "What color do you get by mixing red and yellow?", options: ["Purple", "Orange", "Green", "Blue"], correct: 1 },
                { question: "Which planet is known as the Red Planet?", options: ["Venus", "Mars", "Jupiter", "Saturn"], correct: 1 },
                { question: "How many continents are there?", options: ["Five", "Six", "Seven", "Eight"], correct: 2 },
                { question: "What is the largest ocean in the world?", options: ["Atlantic", "Pacific", "Indian", "Arctic"], correct: 1 },
                { question: "What is H2O commonly known as?", options: ["Salt", "Water", "Sugar", "Oil"], correct: 1 },
                { question: "How many sides does a triangle have?", options: ["Two", "Three", "Four", "Five"], correct: 1 },
                { question: "What is the tallest mammal in the world?", options: ["Elephant", "Giraffe", "Horse", "Rhino"], correct: 1 },
                { question: "Which Disney movie features the song 'Let It Go'?", options: ["Moana", "Frozen", "Tangled", "Brave"], correct: 1 },
                { question: "What do bees produce?", options: ["Milk", "Honey", "Cheese", "Butter"], correct: 1 }
            ],
            medium: [
                { question: "What is the smallest country in the world?", options: ["Monaco", "Vatican City", "San Marino", "Liechtenstein"], correct: 1 },
                { question: "Which element has the chemical symbol 'Au'?", options: ["Silver", "Gold", "Aluminum", "Argon"], correct: 1 },
                { question: "Who painted the Mona Lisa?", options: ["Van Gogh", "Picasso", "Da Vinci", "Monet"], correct: 2 },
                { question: "What is the longest river in the world?", options: ["Amazon", "Nile", "Yangtze", "Mississippi"], correct: 1 },
                { question: "Which organ in the human body produces insulin?", options: ["Liver", "Pancreas", "Kidney", "Heart"], correct: 1 },
                { question: "What is the currency of Japan?", options: ["Won", "Yuan", "Yen", "Rupee"], correct: 2 },
                { question: "Which planet is closest to the sun?", options: ["Venus", "Mercury", "Earth", "Mars"], correct: 1 },
                { question: "What is the square root of 144?", options: ["10", "11", "12", "13"], correct: 2 },
                { question: "Which country is known as the Land of the Rising Sun?", options: ["China", "Japan", "Korea", "Thailand"], correct: 1 },
                { question: "What gas makes up about 78% of Earth's atmosphere?", options: ["Oxygen", "Nitrogen", "Carbon Dioxide", "Argon"], correct: 1 }
            ],
            hard: [
                { question: "What is the hardest natural substance on Earth?", options: ["Gold", "Iron", "Diamond", "Platinum"], correct: 2 },
                { question: "Which scientist developed the theory of relativity?", options: ["Newton", "Einstein", "Hawking", "Curie"], correct: 1 },
                { question: "What is the smallest unit of matter?", options: ["Molecule", "Atom", "Neutron", "Electron"], correct: 1 },
                { question: "Which empire was ruled by Julius Caesar?", options: ["Greek", "Roman", "Byzantine", "Ottoman"], correct: 1 },
                { question: "What is the most abundant gas in the universe?", options: ["Oxygen", "Nitrogen", "Hydrogen", "Helium"], correct: 2 },
                { question: "Which bone is the longest in the human body?", options: ["Tibia", "Humerus", "Radius", "Femur"], correct: 3 },
                { question: "What is the capital of Australia?", options: ["Sydney", "Melbourne", "Canberra", "Perth"], correct: 2 },
                { question: "Which blood type is known as the universal donor?", options: ["A", "B", "AB", "O"], correct: 3 },
                { question: "What is the study of earthquakes called?", options: ["Geology", "Seismology", "Meteorology", "Oceanography"], correct: 1 },
                { question: "Which vitamin is produced when skin is exposed to sunlight?", options: ["Vitamin A", "Vitamin C", "Vitamin D", "Vitamin K"], correct: 2 }
            ]
        };

        // Animal trivia questions
        const animalTriviaQuestions = {
            easy: [
                { question: "What mammal has the most powerful bite in the world?", options: ["Lion", "Hippopotamus", "Grizzly bear"], correct: 1 },
                { question: "What is a male swan called?", options: ["Cob", "Gander", "Drake"], correct: 0 },
                { question: "What is the fastest land mammal?", options: ["Cheetah", "Lion", "Greyhound"], correct: 0 },
                { question: "Which animal's fingerprints are nearly identical to humans?", options: ["Gorilla", "Koala", "Chimpanzee"], correct: 1 },
                { question: "What is the only mammal capable of true sustained flight?", options: ["Bat", "Flying squirrel", "Hawk"], correct: 0 },
                { question: "How many legs do spiders have?", options: ["6", "8", "10"], correct: 1 },
                { question: "Which animal breathes through its skin?", options: ["Frog", "Snake", "Lizard"], correct: 0 },
                { question: "What is the largest living bird?", options: ["Eagle", "Ostrich", "Albatross"], correct: 1 },
                { question: "Which animal is known to have the most teeth?", options: ["Shark", "Crocodile", "Snail"], correct: 2 },
                { question: "What color is the polar bear's skin beneath its fur?", options: ["Black", "White", "Pink"], correct: 0 }
            ],
            medium: [
                { question: "What bird has the largest wingspan?", options: ["Andean condor", "Wandering albatross", "Bald eagle"], correct: 1 },
                { question: "How many eyes does a honeybee have?", options: ["2", "5", "8"], correct: 1 },
                { question: "How many degrees can an owl rotate its head?", options: ["180¬∞", "270¬∞", "360¬∞"], correct: 1 },
                { question: "What is the gestation period of an elephant?", options: ["12 months", "18 months", "22 months"], correct: 2 },
                { question: "Which animal has the longest lifespan?", options: ["Tortoise", "Whale", "Jellyfish"], correct: 2 },
                { question: "What is the smallest mammal in the world?", options: ["Shrew", "Bat", "Mouse"], correct: 1 },
                { question: "How many chambers does a cow's stomach have?", options: ["2", "3", "4"], correct: 2 },
                { question: "Which animal can change its color?", options: ["Octopus", "Chameleon", "Both"], correct: 2 },
                { question: "What is the loudest animal on Earth?", options: ["Lion", "Blue whale", "Howler monkey"], correct: 1 },
                { question: "Which animal sleeps standing up?", options: ["Giraffe", "Horse", "Both"], correct: 2 }
            ],
            hard: [
                { question: "What animal possesses the largest single eye of any living creature?", options: ["Elephant", "Colossal squid", "Whale shark"], correct: 1 },
                { question: "Which bird sings over 100 different songs during courtship?", options: ["Nightingale", "Lyrebird", "Mockingbird"], correct: 1 },
                { question: "What mammal has fur so dense it can trap air and never get wet?", options: ["Sea otter", "Polar bear", "Beaver"], correct: 0 },
                { question: "The only mammal with scales is:", options: ["Pangolin", "Armadillo", "Anteater"], correct: 0 },
                { question: "Which fish produces light as a communication tool in deep oceans?", options: ["Lanternfish", "Anglerfish", "Goby"], correct: 0 },
                { question: "What insect is biologically immortal and is only killed by disease or injury?", options: ["Fruit fly", "Turritopsis jellyfish", "Atlas moth"], correct: 1 },
                { question: "Which amphibian can regenerate brain, spinal cord, and limbs?", options: ["Axolotl", "Frog", "Toad"], correct: 0 },
                { question: "What animal is the most trafficked mammal in the world?", options: ["Pangolin", "Tiger", "Elephant"], correct: 0 },
                { question: "Which bird migrates almost pole-to-pole every year?", options: ["Arctic tern", "Swallow", "Albatross"], correct: 0 },
                { question: "Which animal uses its own fecal matter as a protective shield?", options: ["Leaf beetle", "Dung beetle", "Millipede"], correct: 0 },
                { question: "What marine mammal sings the longest and most complex songs in nature?", options: ["Dolphin", "Humpback whale", "Manatee"], correct: 1 },
                { question: "Which animal has the highest sound decibel vocalization?", options: ["Lion", "Tiger shrimps", "Elephant"], correct: 1 },
                { question: "Star-nosed moles can detect prey in:", options: ["500 milliseconds", "8 milliseconds", "1 second"], correct: 1 },
                { question: "The animal with the most teeth in the world is:", options: ["Catfish", "Snail", "Shark"], correct: 1 },
                { question: "Which reptile is the most venomous on Earth?", options: ["Inland taipan", "King cobra", "Black mamba"], correct: 0 },
                { question: "Which mammal's eye color changes with the seasons for adaptation?", options: ["Rabbit", "Reindeer", "Fox"], correct: 1 },
                { question: "Which fish can climb trees to feed on insects?", options: ["Archerfish", "Climbing perch", "Salmon"], correct: 1 },
                { question: "Which primate is the only 'venomous' one?", options: ["Bonobo", "Slow loris", "Tamarind"], correct: 1 },
                { question: "Which crustacean can snap its claw so fast it generates light and sound?", options: ["Tiger shrimp", "Mantis shrimp", "Ghost crab"], correct: 1 },
                { question: "Which mammal lacks conventional 'eyeballs,' having tubular eyes instead?", options: ["Dolphin", "Owl", "Bat"], correct: 1 },
                { question: "Which amphibian is permanently larval and never matures fully?", options: ["Axolotl", "Salamander", "Newt"], correct: 0 },
                { question: "Which whale can dive for hours and reach depths of over 10,000 feet?", options: ["Blue whale", "Sperm whale", "Beluga"], correct: 1 },
                { question: "The only known animal to taste with its feet:", options: ["Butterfly", "Beetle", "Moth"], correct: 0 },
                { question: "Which bird can mimic chainsaws and car alarms?", options: ["Lyrebird", "Parrot", "Jay"], correct: 0 },
                { question: "Which spider has a red hourglass mark and highly neurotoxic venom?", options: ["Black widow", "Brown recluse", "Tarantula"], correct: 0 },
                { question: "Which animal's tusk is actually a tooth?", options: ["Elephant", "Walrus", "Narwhal"], correct: 2 },
                { question: "Which marine animal is able to inflate itself like a balloon for defense?", options: ["Pufferfish", "Sea cucumber", "Blenny"], correct: 0 },
                { question: "Which reptile can run across water for several meters?", options: ["Gecko", "Basilisk lizard", "Anole lizard"], correct: 1 },
                { question: "Which mammal has the longest continuous migration?", options: ["Bat", "Blue whale", "Caribou"], correct: 2 },
                { question: "What bird lays the largest egg relative to body size?", options: ["Ostrich", "Kiwi", "Albatross"], correct: 1 },
                { question: "Which animal breathes through its butt (cloaca) during winter dormancy?", options: ["Painted turtle", "Otter", "Swan"], correct: 0 },
                { question: "Which fish has the largest leg span among arthropods?", options: ["Japanese spider crab", "Lobster", "Giant isopod"], correct: 0 },
                { question: "Which rodent has no paw pads, just fur?", options: ["Squirrel", "Rabbit", "Rat"], correct: 1 },
                { question: "Which bat has the largest skull in relation to body size?", options: ["Hammerhead bat", "Fruit bat", "Vampire bat"], correct: 0 },
                { question: "Which whale can produce the lowest frequency sound?", options: ["Bowhead", "Blue whale", "Orca"], correct: 1 },
                { question: "Which animal holds its breath for over 6 hours underwater?", options: ["Sea turtle", "Crocodile", "Sloth"], correct: 1 },
                { question: "Which bird uses its own saliva to build nests?", options: ["Swiftlet", "Kingfisher", "Magpie"], correct: 0 },
                { question: "Which fish can live up to 40 years and survive extreme conditions?", options: ["Lungfish", "Sturgeon", "Guppy"], correct: 0 },
                { question: "Which insect can make a shield out of feces?", options: ["Leaf beetle", "Weevil", "Caterpillar"], correct: 0 },
                { question: "Which marine animal can boil water with the speed of its punch?", options: ["Crab", "Mantis shrimp", "Lobster"], correct: 1 },
                { question: "Which land animal has the largest bite force?", options: ["Crocodile", "Hippopotamus", "Tiger"], correct: 1 },
                { question: "Which fish navigates by detecting electric fields?", options: ["Catfish", "Electric eel", "Grouper"], correct: 0 },
                { question: "Which ant species builds massive floating colonies during floods?", options: ["Army ant", "Leafcutter ant", "Fire ant"], correct: 2 },
                { question: "Which shark lays the largest egg?", options: ["Great white shark", "Whale shark", "Zebra shark"], correct: 2 },
                { question: "What animal can sleep for up to three years?", options: ["Snail", "Bear", "Sloth"], correct: 0 },
                { question: "Which bird can mimic human speech and machinery?", options: ["Crow", "Parrot", "Starling"], correct: 1 },
                { question: "Which amphibian can tolerate the most extreme cold?", options: ["Siberian newt", "Wood frog", "Axolotl"], correct: 1 },
                { question: "Which mammal uses tools in nature to dig and break nuts?", options: ["Otter", "Chimpanzee", "Dolphin"], correct: 1 },
                { question: "Which desert animal never drinks liquid water?", options: ["Kangaroo rat", "Gerbil", "Camel"], correct: 0 },
                { question: "Which bird migrates the greatest distance, nearly the circumference of Earth?", options: ["Arctic tern", "Swallow", "Crane"], correct: 0 },
                { question: "Which fish has antifreeze proteins to survive freezing water?", options: ["Antarctic icefish", "Tuna", "Salmon"], correct: 0 },
                { question: "Which mammal uses sonar 'echolocation' for navigation and hunting?", options: ["Bat", "Whale", "Mole"], correct: 0 },
                { question: "What is the densest bone in any mammal found in?", options: ["Elephant", "Whale", "Hippo"], correct: 1 },
                { question: "Which insect has the shortest lifespan?", options: ["Fruit fly", "Dragonfly", "Mayfly"], correct: 2 }
            ]
        };

        // School Trivia Questions
        const schoolTriviaQuestions = {
            math: {
                elementary: [
                    { question: "What is 5 + 3?", options: ["7", "8", "9"], correct: 1 },
                    { question: "How many sides does a triangle have?", options: ["2", "3", "4"], correct: 1 },
                    { question: "What is 10 - 4?", options: ["5", "6", "7"], correct: 1 },
                    { question: "How many minutes are in an hour?", options: ["50", "60", "70"], correct: 1 },
                    { question: "What is 6 √ó 2?", options: ["10", "12", "14"], correct: 1 },
                    { question: "How many days are in a week?", options: ["6", "7", "8"], correct: 1 },
                    { question: "What shape has 4 equal sides?", options: ["Circle", "Square", "Triangle"], correct: 1 },
                    { question: "What is half of 10?", options: ["4", "5", "6"], correct: 1 },
                    { question: "How many cents equal one dollar?", options: ["50", "100", "200"], correct: 1 },
                    { question: "What is 15 √∑ 3?", options: ["4", "5", "6"], correct: 1 }
                ],
                middle: [
                    { question: "What is 12¬≤?", options: ["124", "144", "154"], correct: 1 },
                    { question: "What is the area of a rectangle with length 8 and width 5?", options: ["30", "40", "50"], correct: 1 },
                    { question: "What is 25% of 80?", options: ["15", "20", "25"], correct: 1 },
                    { question: "What is the circumference formula for a circle?", options: ["œÄr¬≤", "2œÄr", "œÄd¬≤"], correct: 1 },
                    { question: "What is the square root of 64?", options: ["6", "8", "10"], correct: 1 },
                    { question: "What is 3/4 as a decimal?", options: ["0.75", "0.25", "0.5"], correct: 0 },
                    { question: "How many degrees are in a triangle?", options: ["90", "180", "360"], correct: 1 },
                    { question: "What is 2‚Å¥?", options: ["8", "16", "32"], correct: 1 },
                    { question: "What is the slope of y = 3x + 2?", options: ["2", "3", "5"], correct: 1 },
                    { question: "What is 7 √ó 8?", options: ["54", "56", "58"], correct: 1 }
                ],
                high: [
                    { question: "What is the derivative of x¬≤?", options: ["x", "2x", "x¬≤"], correct: 1 },
                    { question: "What is sin(90¬∞)?", options: ["0", "1", "‚àö2/2"], correct: 1 },
                    { question: "What is the quadratic formula?", options: ["x = -b ¬± ‚àö(b¬≤-4ac)/2a", "x = b ¬± ‚àö(b¬≤+4ac)/2a", "x = -b ¬± ‚àö(b¬≤+4ac)/2a"], correct: 0 },
                    { question: "What is log‚ÇÅ‚ÇÄ(100)?", options: ["1", "2", "10"], correct: 1 },
                    { question: "What is the integral of 2x?", options: ["x¬≤", "x¬≤ + C", "2x¬≤"], correct: 1 },
                    { question: "What is the value of œÄ (approximately)?", options: ["3.14", "3.15", "3.16"], correct: 0 },
                    { question: "What is cos(60¬∞)?", options: ["1/2", "‚àö3/2", "‚àö2/2"], correct: 0 },
                    { question: "What is the sum of angles in a quadrilateral?", options: ["180¬∞", "360¬∞", "540¬∞"], correct: 1 },
                    { question: "What is e (approximately)?", options: ["2.71", "2.72", "2.73"], correct: 1 },
                    { question: "What is the slope-intercept form of a line?", options: ["y = mx + b", "y = bx + m", "x = my + b"], correct: 0 }
                ]
            },
            science: {
                elementary: [
                    { question: "How many legs does an insect have?", options: ["4", "6", "8"], correct: 1 },
                    { question: "What do plants need to make food?", options: ["Water only", "Sunlight and water", "Soil only"], correct: 1 },
                    { question: "Which planet is closest to the Sun?", options: ["Venus", "Mercury", "Mars"], correct: 1 },
                    { question: "What do you call baby frogs?", options: ["Puppies", "Tadpoles", "Kittens"], correct: 1 },
                    { question: "How many bones do sharks have?", options: ["100", "0", "50"], correct: 1 },
                    { question: "What gas do plants give off?", options: ["Carbon dioxide", "Oxygen", "Nitrogen"], correct: 1 },
                    { question: "How many chambers does a human heart have?", options: ["2", "3", "4"], correct: 2 },
                    { question: "What is the Earth's natural satellite?", options: ["Sun", "Moon", "Mars"], correct: 1 },
                    { question: "What do caterpillars turn into?", options: ["Spiders", "Butterflies", "Bees"], correct: 1 },
                    { question: "Which is the largest ocean?", options: ["Atlantic", "Pacific", "Indian"], correct: 1 }
                ],
                middle: [
                    { question: "What is the chemical symbol for water?", options: ["H2O", "CO2", "O2"], correct: 0 },
                    { question: "What is the powerhouse of the cell?", options: ["Nucleus", "Mitochondria", "Ribosome"], correct: 1 },
                    { question: "What is the speed of light?", options: ["300,000 km/s", "3,000,000 km/s", "30,000 km/s"], correct: 0 },
                    { question: "What is the atomic number of carbon?", options: ["5", "6", "7"], correct: 1 },
                    { question: "What force keeps planets in orbit?", options: ["Magnetism", "Gravity", "Friction"], correct: 1 },
                    { question: "What is photosynthesis?", options: ["Plants eating animals", "Plants making food from sunlight", "Plants sleeping"], correct: 1 },
                    { question: "What is the closest star to Earth?", options: ["North Star", "Sun", "Sirius"], correct: 1 },
                    { question: "What is the pH of pure water?", options: ["6", "7", "8"], correct: 1 },
                    { question: "What gas makes up most of Earth's atmosphere?", options: ["Oxygen", "Nitrogen", "Carbon dioxide"], correct: 1 },
                    { question: "What is the smallest unit of matter?", options: ["Molecule", "Atom", "Cell"], correct: 1 }
                ],
                high: [
                    { question: "What is Avogadro's number?", options: ["6.02 √ó 10¬≤¬≥", "6.02 √ó 10¬≤¬≤", "6.02 √ó 10¬≤‚Å¥"], correct: 0 },
                    { question: "What is the first law of thermodynamics?", options: ["Energy cannot be created or destroyed", "For every action there is an equal and opposite reaction", "Objects in motion stay in motion"], correct: 0 },
                    { question: "What is DNA's complementary base to Adenine?", options: ["Guanine", "Thymine", "Cytosine"], correct: 1 },
                    { question: "What is the chemical formula for glucose?", options: ["C6H12O6", "C12H22O11", "C2H6O"], correct: 0 },
                    { question: "What is the uncertainty principle?", options: ["Heisenberg's principle", "Newton's principle", "Einstein's principle"], correct: 0 },
                    { question: "What organelle contains chlorophyll?", options: ["Mitochondria", "Chloroplast", "Nucleus"], correct: 1 },
                    { question: "What is the molar mass of water?", options: ["16 g/mol", "18 g/mol", "20 g/mol"], correct: 1 },
                    { question: "What is the process of cell division?", options: ["Meiosis only", "Mitosis only", "Both mitosis and meiosis"], correct: 2 },
                    { question: "What is the charge of a proton?", options: ["Negative", "Positive", "Neutral"], correct: 1 },
                    { question: "What is the periodic table organized by?", options: ["Atomic mass", "Atomic number", "Electron number"], correct: 1 }
                ]
            },
            english: {
                elementary: [
                    { question: "What is a noun?", options: ["Action word", "Person, place, or thing", "Describing word"], correct: 1 },
                    { question: "What is a verb?", options: ["Action word", "Person, place, or thing", "Describing word"], correct: 0 },
                    { question: "How many letters are in the alphabet?", options: ["24", "25", "26"], correct: 2 },
                    { question: "What is an adjective?", options: ["Action word", "Person, place, or thing", "Describing word"], correct: 2 },
                    { question: "What is the opposite of 'big'?", options: ["Large", "Small", "Huge"], correct: 1 },
                    { question: "What punctuation ends a question?", options: ["Period", "Question mark", "Exclamation point"], correct: 1 },
                    { question: "What is a synonym for 'happy'?", options: ["Sad", "Joyful", "Angry"], correct: 1 },
                    { question: "How many syllables are in 'butterfly'?", options: ["2", "3", "4"], correct: 1 },
                    { question: "What is the plural of 'child'?", options: ["Childs", "Children", "Childrens"], correct: 1 },
                    { question: "What is an antonym for 'hot'?", options: ["Warm", "Cold", "Cool"], correct: 1 }
                ],
                middle: [
                    { question: "What is a metaphor?", options: ["Direct comparison using 'like' or 'as'", "Indirect comparison", "Exaggeration"], correct: 1 },
                    { question: "What is alliteration?", options: ["Repetition of vowel sounds", "Repetition of consonant sounds", "Rhyming words"], correct: 1 },
                    { question: "What is the subject in 'The dog ran quickly'?", options: ["dog", "ran", "quickly"], correct: 0 },
                    { question: "What is personification?", options: ["Giving human qualities to non-human things", "Comparing two things", "Exaggerating"], correct: 0 },
                    { question: "What is the past tense of 'run'?", options: ["Runned", "Ran", "Running"], correct: 1 },
                    { question: "What is a simile?", options: ["Direct comparison using 'like' or 'as'", "Indirect comparison", "Exaggeration"], correct: 0 },
                    { question: "What part of speech is 'quickly'?", options: ["Noun", "Verb", "Adverb"], correct: 2 },
                    { question: "What is the main idea of a paragraph?", options: ["First sentence", "Central topic", "Last sentence"], correct: 1 },
                    { question: "What is onomatopoeia?", options: ["Word that imitates sound", "Repetition of sounds", "Comparison"], correct: 0 },
                    { question: "What is a compound sentence?", options: ["One independent clause", "Two independent clauses", "Three independent clauses"], correct: 1 }
                ],
                high: [
                    { question: "What is iambic pentameter?", options: ["5 feet of unstressed-stressed syllables", "4 feet of stressed-unstressed syllables", "6 feet of unstressed-stressed syllables"], correct: 0 },
                    { question: "Who wrote 'Romeo and Juliet'?", options: ["Charles Dickens", "William Shakespeare", "Mark Twain"], correct: 1 },
                    { question: "What is a thesis statement?", options: ["Concluding sentence", "Main argument", "Supporting detail"], correct: 1 },
                    { question: "What is dramatic irony?", options: ["Audience knows more than characters", "Opposite of what's expected", "Exaggeration"], correct: 0 },
                    { question: "What is the difference between 'who' and 'whom'?", options: ["No difference", "Who is subject, whom is object", "Whom is subject, who is object"], correct: 1 },
                    { question: "What is a soliloquy?", options: ["Character speaking to audience alone", "Conversation between two characters", "Narrator's voice"], correct: 0 },
                    { question: "What is symbolism?", options: ["Using objects to represent ideas", "Repeating words", "Comparing things"], correct: 0 },
                    { question: "What is the passive voice?", options: ["Subject performs action", "Subject receives action", "No subject"], correct: 1 },
                    { question: "What is an oxymoron?", options: ["Contradictory terms together", "Exaggeration", "Repetition"], correct: 0 },
                    { question: "What is the difference between 'affect' and 'effect'?", options: ["No difference", "Affect is verb, effect is noun", "Effect is verb, affect is noun"], correct: 1 }
                ]
            },
            history: {
                elementary: [
                    { question: "Who was the first President of the United States?", options: ["Abraham Lincoln", "George Washington", "Thomas Jefferson"], correct: 1 },
                    { question: "What holiday celebrates American independence?", options: ["Memorial Day", "4th of July", "Labor Day"], correct: 1 },
                    { question: "What ocean did Columbus cross to reach America?", options: ["Pacific", "Atlantic", "Indian"], correct: 1 },
                    { question: "What is the Statue of Liberty holding?", options: ["Flag", "Torch", "Book"], correct: 1 },
                    { question: "Who was the 16th President?", options: ["George Washington", "Abraham Lincoln", "Theodore Roosevelt"], correct: 1 },
                    { question: "What war was fought between North and South?", options: ["Revolutionary War", "Civil War", "World War I"], correct: 1 },
                    { question: "What did the Pilgrims come to America on?", options: ["Mayflower", "Titanic", "Santa Maria"], correct: 0 },
                    { question: "What is the capital of the United States?", options: ["New York", "Washington D.C.", "Boston"], correct: 1 },
                    { question: "Who helped Lewis and Clark explore the West?", options: ["Pocahontas", "Sacagawea", "Betsy Ross"], correct: 1 },
                    { question: "What document declared American independence?", options: ["Constitution", "Declaration of Independence", "Bill of Rights"], correct: 1 }
                ],
                middle: [
                    { question: "What year did World War II end?", options: ["1944", "1945", "1946"], correct: 1 },
                    { question: "Who wrote the Declaration of Independence?", options: ["George Washington", "Thomas Jefferson", "Benjamin Franklin"], correct: 1 },
                    { question: "What was the first permanent English settlement?", options: ["Plymouth", "Jamestown", "Boston"], correct: 1 },
                    { question: "What war began in 1861?", options: ["Revolutionary War", "Civil War", "War of 1812"], correct: 1 },
                    { question: "Who was President during the Civil War?", options: ["Abraham Lincoln", "George Washington", "Thomas Jefferson"], correct: 0 },
                    { question: "What caused the Great Depression?", options: ["Stock market crash", "World War I", "Dust Bowl"], correct: 0 },
                    { question: "What amendment gave women the right to vote?", options: ["18th", "19th", "20th"], correct: 1 },
                    { question: "Who was the main author of the Constitution?", options: ["George Washington", "James Madison", "Alexander Hamilton"], correct: 1 },
                    { question: "What purchase doubled the size of the U.S.?", options: ["Alaska Purchase", "Louisiana Purchase", "Gadsden Purchase"], correct: 1 },
                    { question: "What year did the Boston Tea Party occur?", options: ["1773", "1774", "1775"], correct: 0 }
                ],
                high: [
                    { question: "What treaty ended World War I?", options: ["Treaty of Versailles", "Treaty of Paris", "Treaty of Ghent"], correct: 0 },
                    { question: "Who was the first Secretary of the Treasury?", options: ["Thomas Jefferson", "Alexander Hamilton", "John Adams"], correct: 1 },
                    { question: "What doctrine warned European powers against colonizing the Americas?", options: ["Truman Doctrine", "Monroe Doctrine", "Eisenhower Doctrine"], correct: 1 },
                    { question: "What Supreme Court case established judicial review?", options: ["Marbury v. Madison", "Brown v. Board", "Plessy v. Ferguson"], correct: 0 },
                    { question: "What act led to the Boston Tea Party?", options: ["Stamp Act", "Tea Act", "Sugar Act"], correct: 1 },
                    { question: "Who was President during the War of 1812?", options: ["Thomas Jefferson", "James Madison", "James Monroe"], correct: 1 },
                    { question: "What compromise resolved the Missouri crisis?", options: ["Great Compromise", "Missouri Compromise", "Connecticut Compromise"], correct: 1 },
                    { question: "What was the first political party?", options: ["Democratic-Republican", "Federalist", "Whig"], correct: 1 },
                    { question: "What movement sought to end slavery?", options: ["Temperance", "Abolitionist", "Suffrage"], correct: 1 },
                    { question: "What war was fought over westward expansion?", options: ["Mexican-American War", "Spanish-American War", "French and Indian War"], correct: 0 }
                ]
            }
        };

        // Geo Guesser Game Data
        const geoGuesserData = {
            world: [
                { name: "Eiffel Tower", country: "France", city: "Paris", continent: "Europe", lat: 48.8584, lon: 2.2945, hint: "Iron lattice tower, symbol of romance" },
                { name: "Great Wall of China", country: "China", city: "Beijing", continent: "Asia", lat: 40.4319, lon: 116.5704, hint: "Ancient fortification, visible from space" },
                { name: "Statue of Liberty", country: "USA", city: "New York", continent: "North America", lat: 40.6892, lon: -74.0445, hint: "Gift from France, symbol of freedom" },
                { name: "Machu Picchu", country: "Peru", city: "Cusco", continent: "South America", lat: -13.1631, lon: -72.5450, hint: "Ancient Incan citadel in the mountains" },
                { name: "Sydney Opera House", country: "Australia", city: "Sydney", continent: "Australia", lat: -33.8568, lon: 151.2153, hint: "Distinctive shell-like design" },
                { name: "Pyramids of Giza", country: "Egypt", city: "Cairo", continent: "Africa", lat: 29.9792, lon: 31.1342, hint: "Ancient tombs of pharaohs" },
                { name: "Big Ben", country: "UK", city: "London", continent: "Europe", lat: 51.5007, lon: -0.1246, hint: "Famous clock tower" },
                { name: "Mount Fuji", country: "Japan", city: "Tokyo", continent: "Asia", lat: 35.3606, lon: 138.7274, hint: "Sacred mountain and volcano" },
                { name: "Christ the Redeemer", country: "Brazil", city: "Rio de Janeiro", continent: "South America", lat: -22.9519, lon: -43.2105, hint: "Massive statue overlooking the city" },
                { name: "Taj Mahal", country: "India", city: "Agra", continent: "Asia", lat: 27.1751, lon: 78.0421, hint: "White marble mausoleum" }
            ],
            usStates: [
                { name: "California", capital: "Sacramento", nickname: "Golden State", region: "West Coast" },
                { name: "Texas", capital: "Austin", nickname: "Lone Star State", region: "South" },
                { name: "Florida", capital: "Tallahassee", nickname: "Sunshine State", region: "Southeast" },
                { name: "New York", capital: "Albany", nickname: "Empire State", region: "Northeast" },
                { name: "Alaska", capital: "Juneau", nickname: "Last Frontier", region: "Pacific" },
                { name: "Hawaii", capital: "Honolulu", nickname: "Aloha State", region: "Pacific" },
                { name: "Colorado", capital: "Denver", nickname: "Centennial State", region: "Mountain West" },
                { name: "Maine", capital: "Augusta", nickname: "Pine Tree State", region: "New England" },
                { name: "Nevada", capital: "Carson City", nickname: "Silver State", region: "Mountain West" },
                { name: "Vermont", capital: "Montpelier", nickname: "Green Mountain State", region: "New England" }
            ],
            continents: [
                { name: "Africa", countries: ["Nigeria", "Egypt", "South Africa", "Kenya", "Morocco"], landmarks: ["Sahara Desert", "Victoria Falls", "Kilimanjaro"] },
                { name: "Asia", countries: ["China", "India", "Japan", "Thailand", "South Korea"], landmarks: ["Himalayas", "Great Wall", "Mount Fuji"] },
                { name: "Europe", countries: ["France", "Germany", "Italy", "Spain", "UK"], landmarks: ["Alps", "Mediterranean Sea", "Eiffel Tower"] },
                { name: "North America", countries: ["USA", "Canada", "Mexico"], landmarks: ["Grand Canyon", "Niagara Falls", "Rocky Mountains"] },
                { name: "South America", countries: ["Brazil", "Argentina", "Peru", "Chile", "Colombia"], landmarks: ["Amazon Rainforest", "Andes Mountains", "Machu Picchu"] },
                { name: "Australia/Oceania", countries: ["Australia", "New Zealand", "Fiji"], landmarks: ["Great Barrier Reef", "Uluru", "Sydney Opera House"] },
                { name: "Antarctica", countries: [], landmarks: ["South Pole", "Research Stations", "Ice Sheets"] }
            ]
        };

        // Navigation functions
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.game-container').forEach(page => {
                page.classList.add('hidden');
            });

            // Show selected page
            document.getElementById(pageName + '-page').classList.remove('hidden');

            // Update navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            gameState.currentPage = pageName;

            // Update stats if returning to home
            if (pageName === 'home') {
                updateUserStats();
            }
        }

        // User stats functions
        function updateUserStats() {
            document.getElementById('total-score').textContent = gameState.userStats.totalScore;
            document.getElementById('games-played').textContent = gameState.userStats.gamesPlayed;
            document.getElementById('games-won').textContent = gameState.userStats.gamesWon;
            
            const winRate = gameState.userStats.gamesPlayed > 0 
                ? Math.round((gameState.userStats.gamesWon / gameState.userStats.gamesPlayed) * 100)
                : 0;
            document.getElementById('win-rate').textContent = winRate + '%';
        }

        function addGameResult(won, score = 0) {
            gameState.userStats.gamesPlayed++;
            if (won) gameState.userStats.gamesWon++;
            gameState.userStats.totalScore += score;
            
            // Save to localStorage
            localStorage.setItem('burbleGameStats', JSON.stringify(gameState.userStats));
        }

        // Load stats from localStorage
        function loadUserStats() {
            const saved = localStorage.getItem('burbleGameStats');
            if (saved) {
                gameState.userStats = JSON.parse(saved);
                updateUserStats();
            }
        }

        // Utility functions
        function showFeedback(gameType, message, type) {
            const feedback = document.getElementById(gameType + '-feedback');
            feedback.innerHTML = `<div class="feedback ${type}">${message}</div>`;
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function startTimer(gameType) {
            const game = gameState[gameType];
            game.startTime = Date.now();
            game.timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - game.startTime) / 1000);
                document.getElementById(gameType + '-timer').textContent = formatTime(elapsed);
            }, 1000);
        }

        function stopTimer(gameType) {
            const game = gameState[gameType];
            if (game.timerInterval) {
                clearInterval(game.timerInterval);
                game.timerInterval = null;
            }
        }

        // RIDDLES GAME
        function initRiddlesGame() {
            // Difficulty selectors
            document.querySelectorAll('#riddles-page .selector-btn[data-difficulty]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#riddles-page .selector-btn[data-difficulty]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.riddles.difficulty = btn.dataset.difficulty;
                    updateRiddlesDisplay();
                });
            });

            // Category selectors
            document.querySelectorAll('#riddles-page .selector-btn[data-category]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#riddles-page .selector-btn[data-category]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.riddles.category = btn.dataset.category;
                    updateRiddlesDisplay();
                });
            });

            // Game buttons
            document.getElementById('riddles-next').addEventListener('click', nextRiddle);
            document.getElementById('riddles-submit').addEventListener('click', submitRiddleAnswer);
            document.getElementById('riddles-hint').addEventListener('click', getRiddleHint);

            // Input handling
            document.getElementById('riddles-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && gameState.riddles.gameActive) {
                    submitRiddleAnswer();
                }
            });

            updateRiddlesDisplay();
        }

        function nextRiddle() {
            const riddles = gameState.riddles;
            
            // Get riddles for current filter
            const availableRiddles = getRiddlesByFilter(riddles.category, riddles.difficulty);
            if (availableRiddles.length === 0) {
                showFeedback('riddles', 'No riddles available for this category/difficulty combination.', 'error');
                return;
            }

            // Select random riddle (avoid duplicate if possible)
            let newRiddle;
            if (availableRiddles.length === 1) {
                newRiddle = availableRiddles[0];
            } else {
                // Try to avoid selecting the same riddle as before
                do {
                    newRiddle = availableRiddles[Math.floor(Math.random() * availableRiddles.length)];
                } while (newRiddle === riddles.currentRiddle && availableRiddles.length > 1);
            }
            riddles.currentRiddle = newRiddle;
            riddles.currentHintLevel = 0;
            riddles.attemptCount = 0;
            riddles.gameActive = true;

            // Display riddle
            document.getElementById('riddles-question').textContent = riddles.currentRiddle.riddle;
            
            // Enable inputs
            document.getElementById('riddles-input').disabled = false;
            document.getElementById('riddles-submit').disabled = false;
            document.getElementById('riddles-hint').disabled = false;
            document.getElementById('riddles-input').focus();
            
            // Clear previous feedback
            document.getElementById('riddles-feedback').innerHTML = '';
            
            updateRiddlesDisplay();
            showFeedback('riddles', 'New riddle loaded! Think carefully about your answer.', 'info');
        }

        function submitRiddleAnswer() {
            if (!gameState.riddles.gameActive || !gameState.riddles.currentRiddle) return;
            
            const answer = document.getElementById('riddles-input').value.trim();
            if (!answer) return;

            const riddles = gameState.riddles;
            riddles.attemptCount++;

            if (checkRiddleAnswer(answer, riddles.currentRiddle.acceptedAnswers)) {
                handleRiddleCorrect();
            } else {
                handleRiddleIncorrect();
            }

            document.getElementById('riddles-input').value = '';
        }

        function handleRiddleCorrect() {
            const riddles = gameState.riddles;
            riddles.gameActive = false;
            riddles.solved++;

            // Calculate score based on difficulty, attempts, and hints used
            let basePoints = 0;
            switch (riddles.difficulty) {
                case 'easy': basePoints = 10; break;
                case 'medium': basePoints = 25; break;
                case 'hard': basePoints = 50; break;
            }

            // Bonus for fewer attempts
            const attemptBonus = Math.max(0, (riddles.maxAttempts - riddles.attemptCount + 1) * 5);
            
            // Penalty for hints (already calculated when hint is used)
            const totalScore = basePoints + attemptBonus;
            riddles.score += totalScore;

            // Disable inputs
            document.getElementById('riddles-input').disabled = true;
            document.getElementById('riddles-submit').disabled = true;
            document.getElementById('riddles-hint').disabled = true;

            addGameResult(true, totalScore);
            updateRiddlesDisplay();
            
            showFeedback('riddles', 
                `üéâ Correct! The answer was "${riddles.currentRiddle.answer}". You earned ${totalScore} points! Click "New Riddle" to continue.`, 
                'success'
            );
        }

        function handleRiddleIncorrect() {
            const riddles = gameState.riddles;
            
            if (riddles.attemptCount >= riddles.maxAttempts) {
                // Game over - show correct answer
                riddles.gameActive = false;
                
                document.getElementById('riddles-input').disabled = true;
                document.getElementById('riddles-submit').disabled = true;
                document.getElementById('riddles-hint').disabled = true;

                addGameResult(false, 0);
                
                showFeedback('riddles', 
                    `‚ùå Incorrect! The answer was "${riddles.currentRiddle.answer}". Click "New Riddle" to try another!`, 
                    'error'
                );
            } else {
                const attemptsLeft = riddles.maxAttempts - riddles.attemptCount;
                showFeedback('riddles', 
                    `‚ùå Incorrect! You have ${attemptsLeft} attempt${attemptsLeft !== 1 ? 's' : ''} left. Try again!`, 
                    'warning'
                );
            }
            
            updateRiddlesDisplay();
        }

        function getRiddleHint() {
            const riddles = gameState.riddles;
            if (!riddles.currentRiddle || !riddles.gameActive) return;

            // Check if hints are available
            const hints = riddles.currentRiddle.hints || [];
            if (riddles.currentHintLevel >= hints.length) {
                showFeedback('riddles', 'üí° No more hints available for this riddle.', 'warning');
                return;
            }

            const currentHint = hints[riddles.currentHintLevel];
            const hintNumber = riddles.currentHintLevel + 1;
            const pointPenalty = (hintNumber * 5) + 5; // Progressive penalty: 10, 15, 20 points

            riddles.hintsUsed++;
            riddles.currentHintLevel++;
            riddles.score = Math.max(0, riddles.score - pointPenalty);

            showFeedback('riddles', `üí° Hint ${hintNumber}: ${currentHint} (-${pointPenalty} points)`, 'info');
            
            updateRiddlesDisplay();
            updateHintButton();
        }

        function updateRiddlesDisplay() {
            const riddles = gameState.riddles;
            
            // Update stats
            document.getElementById('riddles-score').textContent = riddles.score;
            document.getElementById('riddles-solved').textContent = riddles.solved;
            document.getElementById('riddles-difficulty').textContent = 
                riddles.difficulty.charAt(0).toUpperCase() + riddles.difficulty.slice(1);
            
            // Update category display
            const categoryDisplay = {
                'all': 'All Types',
                'logic': 'Logic',
                'word': 'Word',
                'math': 'Math', 
                'lateral': 'Lateral Thinking'
            };
            document.getElementById('riddles-category').textContent = categoryDisplay[riddles.category] || riddles.category;
        }

        function updateHintButton() {
            const riddles = gameState.riddles;
            const hintButton = document.getElementById('riddles-hint');
            
            if (!riddles.currentRiddle || !riddles.gameActive) {
                hintButton.disabled = true;
                hintButton.textContent = 'Get Hint';
                return;
            }

            const hints = riddles.currentRiddle.hints || [];
            const hintsRemaining = hints.length - riddles.currentHintLevel;
            
            if (hintsRemaining <= 0) {
                hintButton.disabled = true;
                hintButton.textContent = 'No More Hints';
            } else {
                hintButton.disabled = false;
                const nextPenalty = ((riddles.currentHintLevel + 1) * 5) + 5;
                hintButton.textContent = `Get Hint ${riddles.currentHintLevel + 1} (-${nextPenalty} pts)`;
            }
        }

        // BURBLE WORD GAME
        function initBurbleGame() {
            // Difficulty selectors
            document.querySelectorAll('#burble-page .selector-btn[data-difficulty]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#burble-page .selector-btn[data-difficulty]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.burble.difficulty = btn.dataset.difficulty;
                    setBurbleMaxAttempts();
                    updateBurbleDisplay();
                });
            });

            // Category selectors
            document.querySelectorAll('#burble-page .selector-btn[data-category]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#burble-page .selector-btn[data-category]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.burble.category = btn.dataset.category;
                    updateBurbleDisplay();
                });
            });

            // Game buttons
            document.getElementById('burble-new-game').addEventListener('click', startBurbleGame);
            document.getElementById('burble-submit').addEventListener('click', submitBurbleGuess);
            document.getElementById('burble-hint').addEventListener('click', getBurbleHint);

            // Input handling
            document.getElementById('burble-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && gameState.burble.gameActive) {
                    submitBurbleGuess();
                }
            });

            setBurbleMaxAttempts();
        }

        function setBurbleMaxAttempts() {
            switch (gameState.burble.difficulty) {
                case 'easy':
                    gameState.burble.maxAttempts = 15;
                    break;
                case 'medium':
                    gameState.burble.maxAttempts = 10;
                    break;
                case 'hard':
                    gameState.burble.maxAttempts = 5;
                    break;
            }
        }

        function startBurbleGame() {
            const burble = gameState.burble;
            
            // Reset game state
            burble.attempts = 0;
            burble.score = 0;
            burble.hintsUsed = 0;
            burble.gameActive = true;
            
            // Select random word
            const category = wordCategories[burble.category];
            const lengths = Object.keys(category);
            const randomLength = lengths[Math.floor(Math.random() * lengths.length)];
            const words = category[randomLength];
            burble.currentWord = words[Math.floor(Math.random() * words.length)];
            
            // Start timer
            startTimer('burble');
            
            // Enable inputs
            document.getElementById('burble-input').disabled = false;
            document.getElementById('burble-submit').disabled = false;
            document.getElementById('burble-hint').disabled = false;
            document.getElementById('burble-input').focus();
            
            updateBurbleDisplay();
            showFeedback('burble', 'Game started! Guess the word.', 'info');
        }

        function submitBurbleGuess() {
            if (!gameState.burble.gameActive) return;
            
            const guess = document.getElementById('burble-input').value.trim().toLowerCase();
            if (!guess) return;
            
            const burble = gameState.burble;
            burble.attempts++;
            
            if (guess === burble.currentWord) {
                handleBurbleWin();
            } else {
                handleBurbleIncorrect(guess);
            }
            
            document.getElementById('burble-input').value = '';
            updateBurbleDisplay();
        }

        function handleBurbleWin() {
            const burble = gameState.burble;
            burble.gameActive = false;
            stopTimer('burble');
            
            const elapsedTime = Math.floor((Date.now() - burble.startTime) / 1000);
            const timeBonus = Math.max(0, 300 - elapsedTime);
            const attemptBonus = Math.max(0, (burble.maxAttempts - burble.attempts) * 10);
            const hintPenalty = burble.hintsUsed * 25;
            burble.score = Math.max(0, 100 + timeBonus + attemptBonus - hintPenalty);
            
            addGameResult(true, burble.score);
            
            showFeedback('burble', `üéâ Correct! The word was "${burble.currentWord}"`, 'correct');
            
            document.getElementById('burble-game-over').innerHTML = `
                <div class="game-over win">
                    <h3>üéâ Congratulations!</h3>
                    <p>You guessed "${burble.currentWord}" correctly!</p>
                    <p><strong>Score:</strong> ${burble.score} points</p>
                    <p><strong>Time:</strong> ${formatTime(Math.floor((Date.now() - burble.startTime) / 1000))}</p>
                    <p><strong>Attempts:</strong> ${burble.attempts}/${burble.maxAttempts}</p>
                </div>
            `;
            
            disableBurbleInputs();
        }

        function handleBurbleIncorrect(guess) {
            const burble = gameState.burble;
            const feedback = generateBurbleFeedback(guess, burble.currentWord);
            
            showFeedback('burble', `‚ùå "${guess}" is incorrect. ${feedback}`, 'incorrect');
            
            if (burble.attempts >= burble.maxAttempts) {
                burble.gameActive = false;
                stopTimer('burble');
                addGameResult(false, 0);
                
                document.getElementById('burble-game-over').innerHTML = `
                    <div class="game-over lose">
                        <h3>üòî Game Over</h3>
                        <p>The word was: <strong>"${burble.currentWord}"</strong></p>
                        <p>Category: ${burble.category}</p>
                        <p>Better luck next time!</p>
                    </div>
                `;
                
                disableBurbleInputs();
            }
        }

        function generateBurbleFeedback(guess, targetWord) {
            if (guess.length !== targetWord.length) {
                return `Try a ${targetWord.length}-letter word.`;
            }
            
            let commonLetters = 0;
            for (let i = 0; i < Math.min(guess.length, targetWord.length); i++) {
                if (targetWord.includes(guess[i])) {
                    commonLetters++;
                }
            }
            
            if (commonLetters === 0) {
                return "No matching letters.";
            } else if (commonLetters === 1) {
                return "1 letter is in the word.";
            } else {
                return `${commonLetters} letters are in the word.`;
            }
        }

        function getBurbleHint() {
            if (!gameState.burble.gameActive) return;
            
            const burble = gameState.burble;
            burble.hintsUsed++;
            
            const hints = [
                `The word is ${burble.currentWord.length} letters long.`,
                `The word is in the ${burble.category} category.`,
                `The word starts with "${burble.currentWord[0]}".`,
                `The word ends with "${burble.currentWord[burble.currentWord.length - 1]}".`,
                `The second letter is "${burble.currentWord[1]}".`
            ];
            
            const hintIndex = Math.min(burble.hintsUsed - 1, hints.length - 1);
            showFeedback('burble', `üí° Hint ${burble.hintsUsed}: ${hints[hintIndex]} (-25 points)`, 'hint');
            
            updateBurbleDisplay();
        }

        function updateBurbleDisplay() {
            const burble = gameState.burble;
            
            document.getElementById('burble-attempts').textContent = `${burble.attempts}/${burble.maxAttempts}`;
            document.getElementById('burble-category').textContent = burble.category;
            document.getElementById('burble-score').textContent = burble.score;
            
            if (burble.currentWord && burble.gameActive) {
                document.getElementById('burble-display').textContent = '_ '.repeat(burble.currentWord.length).trim();
            } else if (burble.currentWord && !burble.gameActive) {
                document.getElementById('burble-display').textContent = burble.currentWord.toUpperCase();
            } else {
                document.getElementById('burble-display').textContent = 'Click "New Game" to start!';
            }
        }

        function disableBurbleInputs() {
            document.getElementById('burble-input').disabled = true;
            document.getElementById('burble-submit').disabled = true;
            document.getElementById('burble-hint').disabled = true;
        }

        // EMOJI GUESS GAME
        function initEmojiGame() {
            // Difficulty selectors
            document.querySelectorAll('#emoji-page .selector-btn[data-difficulty]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#emoji-page .selector-btn[data-difficulty]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.emoji.difficulty = btn.dataset.difficulty;
                    updateEmojiDisplay();
                });
            });

            // Category selectors
            document.querySelectorAll('#emoji-page .selector-btn[data-category]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#emoji-page .selector-btn[data-category]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.emoji.category = btn.dataset.category;
                    updateEmojiDisplay();
                });
            });

            // Game buttons
            document.getElementById('emoji-new-puzzle').addEventListener('click', startEmojiGame);
            document.getElementById('emoji-submit').addEventListener('click', submitEmojiAnswer);
            document.getElementById('emoji-hint').addEventListener('click', getEmojiHint);

            // Input handling
            document.getElementById('emoji-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && gameState.emoji.gameActive) {
                    submitEmojiAnswer();
                }
            });
        }

        function startEmojiGame() {
            const emoji = gameState.emoji;
            
            // Get available puzzles
            let availablePuzzles = [];
            if (emoji.category === 'all') {
                Object.values(emojiPuzzles).forEach(puzzles => {
                    availablePuzzles.push(...puzzles);
                });
            } else {
                availablePuzzles = emojiPuzzles[emoji.category] || [];
            }
            
            if (availablePuzzles.length === 0) {
                showFeedback('emoji', 'No puzzles available for this category!', 'incorrect');
                return;
            }
            
            // Select random puzzle
            emoji.currentPuzzle = availablePuzzles[Math.floor(Math.random() * availablePuzzles.length)];
            emoji.gameActive = true;
            emoji.hintsUsed = 0;
            
            // Enable inputs
            document.getElementById('emoji-input').disabled = false;
            document.getElementById('emoji-submit').disabled = false;
            document.getElementById('emoji-hint').disabled = false;
            document.getElementById('emoji-input').focus();
            
            updateEmojiDisplay();
            showFeedback('emoji', 'New puzzle! What does this emoji combination represent?', 'info');
        }

        function submitEmojiAnswer() {
            if (!gameState.emoji.gameActive) return;
            
            const answer = document.getElementById('emoji-input').value.trim();
            if (!answer) return;
            
            const emoji = gameState.emoji;
            const correctAnswer = emoji.currentPuzzle.answer.toLowerCase();
            const userAnswer = answer.toLowerCase();
            
            if (userAnswer === correctAnswer || correctAnswer.includes(userAnswer) || userAnswer.includes(correctAnswer)) {
                handleEmojiWin();
            } else {
                handleEmojiIncorrect();
            }
            
            document.getElementById('emoji-input').value = '';
        }

        function handleEmojiWin() {
            const emoji = gameState.emoji;
            emoji.gameActive = false;
            
            const baseScore = 100;
            const hintPenalty = emoji.hintsUsed * 5;
            const difficultyBonus = emoji.difficulty === 'hard' ? 50 : emoji.difficulty === 'medium' ? 25 : 0;
            emoji.score += Math.max(10, baseScore - hintPenalty + difficultyBonus);
            
            addGameResult(true, baseScore - hintPenalty + difficultyBonus);
            
            showFeedback('emoji', `üéâ Correct! The answer was "${emoji.currentPuzzle.answer}"`, 'correct');
            
            document.getElementById('emoji-game-over').innerHTML = `
                <div class="game-over win">
                    <h3>üéâ Excellent!</h3>
                    <p>You solved: ${emoji.currentPuzzle.emoji}</p>
                    <p><strong>Answer:</strong> ${emoji.currentPuzzle.answer}</p>
                    <p><strong>Score:</strong> ${baseScore - (emoji.hintsUsed * 5) + difficultyBonus} points</p>
                    <p><strong>Hints used:</strong> ${emoji.hintsUsed}</p>
                </div>
            `;
            
            disableEmojiInputs();
            updateEmojiDisplay();
        }

        function handleEmojiIncorrect() {
            showFeedback('emoji', '‚ùå Incorrect! Try again or get a hint.', 'incorrect');
        }

        function getEmojiHint() {
            if (!gameState.emoji.gameActive) return;
            
            const emoji = gameState.emoji;
            emoji.hintsUsed++;
            
            showFeedback('emoji', `üí° Hint: ${emoji.currentPuzzle.hint} (-5 points)`, 'hint');
            updateEmojiDisplay();
        }

        function updateEmojiDisplay() {
            const emoji = gameState.emoji;
            
            document.getElementById('emoji-score').textContent = emoji.score;
            document.getElementById('emoji-hints').textContent = emoji.hintsUsed;
            document.getElementById('emoji-category').textContent = emoji.category.charAt(0).toUpperCase() + emoji.category.slice(1);
            document.getElementById('emoji-difficulty').textContent = emoji.difficulty.charAt(0).toUpperCase() + emoji.difficulty.slice(1);
            
            if (emoji.currentPuzzle && emoji.gameActive) {
                document.getElementById('emoji-display').textContent = emoji.currentPuzzle.emoji;
            } else if (emoji.currentPuzzle && !emoji.gameActive) {
                document.getElementById('emoji-display').textContent = emoji.currentPuzzle.emoji;
            } else {
                document.getElementById('emoji-display').textContent = 'Click "New Puzzle" to start!';
            }
        }

        function disableEmojiInputs() {
            document.getElementById('emoji-input').disabled = true;
            document.getElementById('emoji-submit').disabled = true;
            document.getElementById('emoji-hint').disabled = true;
        }

        // TWENTY QUESTIONS GAME
        function initValentineGame() {
            // Difficulty selectors
            document.querySelectorAll('#valentine-page .selector-btn[data-difficulty]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#valentine-page .selector-btn[data-difficulty]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.valentine.difficulty = btn.dataset.difficulty;
                    setValentineQuestions();
                    updateValentineDisplay();
                });
            });

            // Category selectors
            document.querySelectorAll('#valentine-page .selector-btn[data-category]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#valentine-page .selector-btn[data-category]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.valentine.category = btn.dataset.category;
                    updateValentineDisplay();
                });
            });

            // Game buttons
            document.getElementById('valentine-new-game').addEventListener('click', startValentineGame);
            document.getElementById('valentine-ask').addEventListener('click', askValentineQuestion);
            document.getElementById('valentine-guess').addEventListener('click', makeValentineGuess);

            // Input handling
            document.getElementById('valentine-question').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && gameState.valentine.gameActive) {
                    askValentineQuestion();
                }
            });

            setValentineQuestions();
        }

        function setValentineQuestions() {
            switch (gameState.valentine.difficulty) {
                case 'easy':
                    gameState.valentine.questionsLeft = 8;
                    break;
                case 'medium':
                    gameState.valentine.questionsLeft = 6;
                    break;
                case 'hard':
                    gameState.valentine.questionsLeft = 4;
                    break;
            }
        }

        function startValentineGame() {
            const valentine = gameState.valentine;
            
            // Reset game state
            valentine.questions = [];
            valentine.answers = [];
            valentine.guessesLeft = 3;
            valentine.gameActive = true;
            valentine.score = 0;
            setValentineQuestions();
            
            // Select random answer
            const categoryAnswers = valentineAnswers[valentine.category];
            valentine.currentAnswer = categoryAnswers[Math.floor(Math.random() * categoryAnswers.length)].answer;
            
            // Enable inputs
            document.getElementById('valentine-question').disabled = false;
            document.getElementById('valentine-ask').disabled = false;
            document.getElementById('valentine-guess').disabled = false;
            document.getElementById('valentine-question').focus();
            
            // Clear history
            document.getElementById('valentine-history').innerHTML = '<p style="text-align: center; color: #666;">Ask yes/no questions to figure out what I\'m thinking of!</p>';
            
            updateValentineDisplay();
            showFeedback('valentine', `I'm thinking of something in the ${valentine.category} category. Ask yes/no questions!`, 'info');
        }

        function askValentineQuestion() {
            if (!gameState.valentine.gameActive) return;
            
            const question = document.getElementById('valentine-question').value.trim();
            if (!question) return;
            
            const valentine = gameState.valentine;
            valentine.questionsLeft--;
            valentine.questions.push(question);
            
            // Generate AI-like response
            const answer = generateValentineAnswer(question, valentine.currentAnswer);
            valentine.answers.push(answer);
            
            // Update history
            updateValentineHistory();
            
            document.getElementById('valentine-question').value = '';
            updateValentineDisplay();
            
            if (valentine.questionsLeft === 0) {
                showFeedback('valentine', 'No more questions! You must make a guess now.', 'hint');
                document.getElementById('valentine-ask').disabled = true;
                document.getElementById('valentine-question').disabled = true;
            }
        }

        function generateValentineAnswer(question, answer) {
            const q = question.toLowerCase();
            const a = answer.toLowerCase();
            
            // Simple keyword matching for basic responses
            if (q.includes('alive') || q.includes('living')) {
                return gameState.valentine.category === 'animals' ? 'Yes' : 'No';
            }
            if (q.includes('animal')) {
                return gameState.valentine.category === 'animals' ? 'Yes' : 'No';
            }
            if (q.includes('place') || q.includes('location')) {
                return gameState.valentine.category === 'places' ? 'Yes' : 'No';
            }
            if (q.includes('movie') || q.includes('film')) {
                return gameState.valentine.category === 'movies' ? 'Yes' : 'No';
            }
            if (q.includes('object') || q.includes('thing')) {
                return gameState.valentine.category === 'objects' ? 'Yes' : 'No';
            }
            if (q.includes('big') || q.includes('large')) {
                return ['elephant', 'giraffe', 'whale', 'titanic', 'avatar'].some(word => a.includes(word)) ? 'Yes' : 'No';
            }
            if (q.includes('small')) {
                return ['phone', 'key', 'watch'].some(word => a.includes(word)) ? 'Yes' : 'No';
            }
            if (q.includes('water')) {
                return ['dolphin', 'titanic', 'sydney', 'paris'].some(word => a.includes(word)) ? 'Yes' : 'No';
            }
            if (q.includes('fly') || q.includes('flight')) {
                return ['penguin', 'avatar'].some(word => a.includes(word)) ? 'Yes' : 'No';
            }
            
            // Random yes/no for other questions
            return Math.random() > 0.5 ? 'Yes' : 'No';
        }

        function makeValentineGuess() {
            if (!gameState.valentine.gameActive) return;
            
            const guess = prompt('What do you think I\'m thinking of?');
            if (!guess) return;
            
            const valentine = gameState.valentine;
            valentine.guessesLeft--;
            
            if (guess.toLowerCase() === valentine.currentAnswer.toLowerCase()) {
                handleValentineWin();
            } else {
                if (valentine.guessesLeft === 0) {
                    handleValentineLose();
                } else {
                    showFeedback('valentine', `‚ùå Not quite! You have ${valentine.guessesLeft} guess(es) left.`, 'incorrect');
                    updateValentineDisplay();
                }
            }
        }

        function handleValentineWin() {
            const valentine = gameState.valentine;
            valentine.gameActive = false;
            
            const baseScore = 100;
            const questionBonus = valentine.questionsLeft * 10;
            const guessBonus = valentine.guessesLeft * 20;
            valentine.score = baseScore + questionBonus + guessBonus;
            
            addGameResult(true, valentine.score);
            
            showFeedback('valentine', `üéâ Correct! I was thinking of "${valentine.currentAnswer}"`, 'correct');
            
            document.getElementById('valentine-game-over').innerHTML = `
                <div class="game-over win">
                    <h3>üéâ Amazing!</h3>
                    <p>You guessed "${valentine.currentAnswer}" correctly!</p>
                    <p><strong>Score:</strong> ${valentine.score} points</p>
                    <p><strong>Questions used:</strong> ${valentine.questions.length}</p>
                    <p><strong>Guesses remaining:</strong> ${valentine.guessesLeft}</p>
                </div>
            `;
            
            disableValentineInputs();
        }

        function handleValentineLose() {
            const valentine = gameState.valentine;
            valentine.gameActive = false;
            
            addGameResult(false, 0);
            
            showFeedback('valentine', `üòî The answer was "${valentine.currentAnswer}". Better luck next time!`, 'incorrect');
            
            document.getElementById('valentine-game-over').innerHTML = `
                <div class="game-over lose">
                    <h3>üòî Game Over</h3>
                    <p>I was thinking of: <strong>"${valentine.currentAnswer}"</strong></p>
                    <p>Category: ${valentine.category}</p>
                    <p>You asked ${valentine.questions.length} questions</p>
                </div>
            `;
            
            disableValentineInputs();
        }

        function updateValentineHistory() {
            const valentine = gameState.valentine;
            const history = document.getElementById('valentine-history');
            
            let historyHTML = '';
            for (let i = 0; i < valentine.questions.length; i++) {
                historyHTML += `
                    <div class="question-item">
                        <div class="question-text">Q: ${valentine.questions[i]}</div>
                        <div class="answer-text">A: ${valentine.answers[i]}</div>
                    </div>
                `;
            }
            
            history.innerHTML = historyHTML || '<p style="text-align: center; color: #666;">Ask yes/no questions to figure out what I\'m thinking of!</p>';
        }

        function updateValentineDisplay() {
            const valentine = gameState.valentine;
            
            document.getElementById('valentine-questions').textContent = valentine.questionsLeft;
            document.getElementById('valentine-guesses').textContent = valentine.guessesLeft;
            document.getElementById('valentine-category').textContent = valentine.category.charAt(0).toUpperCase() + valentine.category.slice(1);
            document.getElementById('valentine-score').textContent = valentine.score;
        }

        function disableValentineInputs() {
            document.getElementById('valentine-question').disabled = true;
            document.getElementById('valentine-ask').disabled = true;
            document.getElementById('valentine-guess').disabled = true;
        }

        // TRIVIA GAME
        function initTriviaGame() {
            // Difficulty selectors
            document.querySelectorAll('#trivia-page .selector-btn[data-difficulty]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#trivia-page .selector-btn[data-difficulty]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.trivia.difficulty = btn.dataset.difficulty;
                });
            });

            // Game buttons
            document.getElementById('trivia-start').addEventListener('click', startTriviaGame);
            document.getElementById('trivia-submit').addEventListener('click', submitTriviaAnswer);
            document.getElementById('trivia-next').addEventListener('click', nextTriviaQuestion);
        }

        function startTriviaGame() {
            const trivia = gameState.trivia;
            
            // Reset game state
            trivia.currentQuestion = 0;
            trivia.correctAnswers = 0;
            trivia.score = 0;
            trivia.gameActive = true;
            trivia.selectedAnswer = null;
            
            // Start timer
            startTimer('trivia');
            
            // Show first question
            showTriviaQuestion();
            
            // Update buttons
            document.getElementById('trivia-start').disabled = true;
            document.getElementById('trivia-submit').disabled = false;
            
            updateTriviaDisplay();
        }

        function showTriviaQuestion() {
            const trivia = gameState.trivia;
            const questions = triviaQuestions[trivia.difficulty];
            
            if (trivia.currentQuestion >= trivia.totalQuestions || trivia.currentQuestion >= questions.length) {
                endTriviaGame();
                return;
            }
            
            const question = questions[trivia.currentQuestion];
            
            document.getElementById('trivia-question-text').textContent = question.question;
            
            const optionsContainer = document.getElementById('trivia-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'trivia-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectTriviaOption(index, optionDiv);
                optionsContainer.appendChild(optionDiv);
            });
            
            trivia.selectedAnswer = null;
            document.getElementById('trivia-submit').disabled = false;
            document.getElementById('trivia-next').disabled = true;
        }

        function selectTriviaOption(index, element) {
            // Remove previous selection
            document.querySelectorAll('#trivia-options .trivia-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Select new option
            element.classList.add('selected');
            gameState.trivia.selectedAnswer = index;
        }

        function submitTriviaAnswer() {
            if (gameState.trivia.selectedAnswer === null) return;
            
            const trivia = gameState.trivia;
            const questions = triviaQuestions[trivia.difficulty];
            const question = questions[trivia.currentQuestion];
            const isCorrect = trivia.selectedAnswer === question.correct;
            
            // Show correct/incorrect styling
            const options = document.querySelectorAll('#trivia-options .trivia-option');
            options.forEach((opt, index) => {
                if (index === question.correct) {
                    opt.classList.add('correct');
                } else if (index === trivia.selectedAnswer && !isCorrect) {
                    opt.classList.add('incorrect');
                }
                opt.onclick = null; // Disable clicking
            });
            
            if (isCorrect) {
                trivia.correctAnswers++;
                trivia.score += trivia.difficulty === 'hard' ? 15 : trivia.difficulty === 'medium' ? 10 : 5;
                showFeedback('trivia', '‚úÖ Correct!', 'correct');
            } else {
                showFeedback('trivia', `‚ùå Incorrect. The correct answer was: ${question.options[question.correct]}`, 'incorrect');
            }
            
            trivia.currentQuestion++;
            
            document.getElementById('trivia-submit').disabled = true;
            document.getElementById('trivia-next').disabled = false;
            
            updateTriviaDisplay();
        }

        function nextTriviaQuestion() {
            if (gameState.trivia.currentQuestion >= gameState.trivia.totalQuestions) {
                endTriviaGame();
            } else {
                showTriviaQuestion();
                document.getElementById('trivia-feedback').innerHTML = '';
            }
        }

        function endTriviaGame() {
            const trivia = gameState.trivia;
            trivia.gameActive = false;
            stopTimer('trivia');
            
            const percentage = Math.round((trivia.correctAnswers / trivia.totalQuestions) * 100);
            const won = percentage >= 70;
            
            addGameResult(won, trivia.score);
            
            document.getElementById('trivia-question-text').textContent = 'Quiz Complete!';
            document.getElementById('trivia-options').innerHTML = '';
            
            document.getElementById('trivia-game-over').innerHTML = `
                <div class="game-over ${won ? 'win' : 'lose'}">
                    <h3>${won ? 'üéâ Great Job!' : 'üìö Keep Studying!'}</h3>
                    <p><strong>Score:</strong> ${trivia.score} points</p>
                    <p><strong>Correct:</strong> ${trivia.correctAnswers}/${trivia.totalQuestions} (${percentage}%)</p>
                    <p><strong>Time:</strong> ${document.getElementById('trivia-timer').textContent}</p>
                    ${won ? '<p>Excellent knowledge!</p>' : '<p>Try again to improve your score!</p>'}
                </div>
            `;
            
            document.getElementById('trivia-start').disabled = false;
            document.getElementById('trivia-submit').disabled = true;
            document.getElementById('trivia-next').disabled = true;
        }

        function updateTriviaDisplay() {
            const trivia = gameState.trivia;
            
            document.getElementById('trivia-question-num').textContent = `${trivia.currentQuestion}/${trivia.totalQuestions}`;
            document.getElementById('trivia-correct').textContent = trivia.correctAnswers;
            document.getElementById('trivia-score').textContent = trivia.score;
        }

        // ANIMAL TRIVIA GAME
        function initAnimalTriviaGame() {
            // Difficulty selectors
            document.querySelectorAll('#animal-trivia-page .selector-btn[data-difficulty]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#animal-trivia-page .selector-btn[data-difficulty]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.animalTrivia.difficulty = btn.dataset.difficulty;
                });
            });

            // Game buttons
            document.getElementById('animal-start').addEventListener('click', startAnimalTriviaGame);
            document.getElementById('animal-submit').addEventListener('click', submitAnimalTriviaAnswer);
            document.getElementById('animal-next').addEventListener('click', nextAnimalTriviaQuestion);
        }

        function startAnimalTriviaGame() {
            const animalTrivia = gameState.animalTrivia;
            
            // Reset game state
            animalTrivia.currentQuestion = 0;
            animalTrivia.correctAnswers = 0;
            animalTrivia.score = 0;
            animalTrivia.gameActive = true;
            animalTrivia.selectedAnswer = null;
            
            // Start timer
            startTimer('animalTrivia');
            
            // Show first question
            showAnimalTriviaQuestion();
            
            // Update buttons
            document.getElementById('animal-start').disabled = true;
            document.getElementById('animal-submit').disabled = false;
            
            updateAnimalTriviaDisplay();
        }

        function showAnimalTriviaQuestion() {
            const animalTrivia = gameState.animalTrivia;
            const questions = animalTriviaQuestions[animalTrivia.difficulty];
            
            if (animalTrivia.currentQuestion >= animalTrivia.totalQuestions || animalTrivia.currentQuestion >= questions.length) {
                endAnimalTriviaGame();
                return;
            }
            
            const question = questions[animalTrivia.currentQuestion];
            
            document.getElementById('animal-question-text').textContent = question.question;
            
            const optionsContainer = document.getElementById('animal-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'trivia-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnimalTriviaOption(index, optionDiv);
                optionsContainer.appendChild(optionDiv);
            });
            
            animalTrivia.selectedAnswer = null;
            document.getElementById('animal-submit').disabled = false;
            document.getElementById('animal-next').disabled = true;
        }

        function selectAnimalTriviaOption(index, element) {
            // Remove previous selection
            document.querySelectorAll('#animal-options .trivia-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Select new option
            element.classList.add('selected');
            gameState.animalTrivia.selectedAnswer = index;
        }

        function submitAnimalTriviaAnswer() {
            if (gameState.animalTrivia.selectedAnswer === null) return;
            
            const animalTrivia = gameState.animalTrivia;
            const questions = animalTriviaQuestions[animalTrivia.difficulty];
            const question = questions[animalTrivia.currentQuestion];
            const isCorrect = animalTrivia.selectedAnswer === question.correct;
            
            // Show correct/incorrect styling
            const options = document.querySelectorAll('#animal-options .trivia-option');
            options.forEach((opt, index) => {
                if (index === question.correct) {
                    opt.classList.add('correct');
                } else if (index === animalTrivia.selectedAnswer && !isCorrect) {
                    opt.classList.add('incorrect');
                }
                opt.onclick = null; // Disable clicking
            });
            
            if (isCorrect) {
                animalTrivia.correctAnswers++;
                animalTrivia.score += animalTrivia.difficulty === 'hard' ? 15 : animalTrivia.difficulty === 'medium' ? 10 : 5;
                showFeedback('animal', '‚úÖ Correct!', 'correct');
            } else {
                showFeedback('animal', `‚ùå Incorrect. The correct answer was: ${question.options[question.correct]}`, 'incorrect');
            }
            
            animalTrivia.currentQuestion++;
            
            document.getElementById('animal-submit').disabled = true;
            document.getElementById('animal-next').disabled = false;
            
            updateAnimalTriviaDisplay();
        }

        function nextAnimalTriviaQuestion() {
            if (gameState.animalTrivia.currentQuestion >= gameState.animalTrivia.totalQuestions) {
                endAnimalTriviaGame();
            } else {
                showAnimalTriviaQuestion();
                document.getElementById('animal-feedback').innerHTML = '';
            }
        }

        function endAnimalTriviaGame() {
            const animalTrivia = gameState.animalTrivia;
            animalTrivia.gameActive = false;
            stopTimer('animalTrivia');
            
            const percentage = Math.round((animalTrivia.correctAnswers / animalTrivia.totalQuestions) * 100);
            const won = percentage >= 70;
            
            addGameResult(won, animalTrivia.score);
            
            document.getElementById('animal-question-text').textContent = 'Quiz Complete!';
            document.getElementById('animal-options').innerHTML = '';
            
            document.getElementById('animal-game-over').innerHTML = `
                <div class="game-over ${won ? 'win' : 'lose'}">
                    <h3>${won ? 'ü¶Å Animal Expert!' : 'üêæ Keep Learning!'}</h3>
                    <p><strong>Score:</strong> ${animalTrivia.score} points</p>
                    <p><strong>Correct:</strong> ${animalTrivia.correctAnswers}/${animalTrivia.totalQuestions} (${percentage}%)</p>
                    <p><strong>Time:</strong> ${document.getElementById('animal-timer').textContent}</p>
                    ${won ? '<p>You know your animals!</p>' : '<p>Study more about animals and try again!</p>'}
                </div>
            `;
            
            document.getElementById('animal-start').disabled = false;
            document.getElementById('animal-submit').disabled = true;
            document.getElementById('animal-next').disabled = true;
        }

        function updateAnimalTriviaDisplay() {
            const animalTrivia = gameState.animalTrivia;
            
            document.getElementById('animal-question-num').textContent = `${animalTrivia.currentQuestion}/${animalTrivia.totalQuestions}`;
            document.getElementById('animal-correct').textContent = animalTrivia.correctAnswers;
            document.getElementById('animal-score').textContent = animalTrivia.score;
        }

        // Initialize all games when page loads
        // AUDIO MANAGER
        function initAudioManager() {
            // Load saved audio files from localStorage
            loadAudioFiles();
            
            // File input handler
            document.getElementById('audio-file-input').addEventListener('change', handleAudioUpload);
        }

        function handleAudioUpload(event) {
            const files = event.target.files;
            for (let file of files) {
                if (file.type.startsWith('audio/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const audioData = {
                            id: Date.now() + Math.random(),
                            name: file.name,
                            size: file.size,
                            type: file.type,
                            data: e.target.result,
                            uploadDate: new Date().toISOString()
                        };
                        
                        gameState.audio.files.push(audioData);
                        saveAudioFiles();
                        displayAudioFiles();
                    };
                    reader.readAsDataURL(file);
                }
            }
        }

        function loadAudioFiles() {
            const saved = localStorage.getItem('burbleAudioFiles');
            if (saved) {
                gameState.audio.files = JSON.parse(saved);
                displayAudioFiles();
            }
        }

        function saveAudioFiles() {
            localStorage.setItem('burbleAudioFiles', JSON.stringify(gameState.audio.files));
        }

        function displayAudioFiles() {
            const container = document.getElementById('audio-files-container');
            
            if (gameState.audio.files.length === 0) {
                container.innerHTML = '<p class="no-files">No audio files uploaded yet.</p>';
                return;
            }

            let html = '';
            gameState.audio.files.forEach(file => {
                html += `
                    <div class="audio-file-item">
                        <div class="audio-file-info">
                            <div>
                                <strong>${file.name}</strong><br>
                                <small>${(file.size / 1024 / 1024).toFixed(2)} MB ‚Ä¢ ${new Date(file.uploadDate).toLocaleDateString()}</small>
                            </div>
                            <audio controls>
                                <source src="${file.data}" type="${file.type}">
                                Your browser does not support the audio element.
                            </audio>
                        </div>
                        <div class="audio-controls">
                            <button class="btn btn-danger" onclick="deleteAudioFile('${file.id}')">Delete</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function deleteAudioFile(fileId) {
            gameState.audio.files = gameState.audio.files.filter(file => file.id != fileId);
            saveAudioFiles();
            displayAudioFiles();
        }

        // SCHOOL TRIVIA GAME
        function initSchoolTriviaGame() {
            // Subject selectors
            document.querySelectorAll('[data-subject]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('[data-subject]').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    gameState.schoolTrivia.subject = e.target.dataset.subject;
                    updateSchoolTriviaDisplay();
                });
            });

            // Grade selectors
            document.querySelectorAll('[data-grade]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('[data-grade]').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    gameState.schoolTrivia.grade = e.target.dataset.grade;
                    updateSchoolTriviaDisplay();
                });
            });

            // Game buttons
            document.getElementById('school-start').addEventListener('click', startSchoolTrivia);
            document.getElementById('school-submit').addEventListener('click', submitSchoolTriviaAnswer);
            document.getElementById('school-next').addEventListener('click', nextSchoolTriviaQuestion);

            updateSchoolTriviaDisplay();
        }

        function startSchoolTrivia() {
            const schoolTrivia = gameState.schoolTrivia;
            schoolTrivia.currentQuestion = 0;
            schoolTrivia.correctAnswers = 0;
            schoolTrivia.score = 0;
            schoolTrivia.gameActive = true;
            schoolTrivia.selectedAnswer = null;

            document.getElementById('school-start').disabled = true;
            showSchoolTriviaQuestion();
            updateSchoolTriviaDisplay();
        }

        function showSchoolTriviaQuestion() {
            const schoolTrivia = gameState.schoolTrivia;
            const questions = schoolTriviaQuestions[schoolTrivia.subject][schoolTrivia.grade];
            
            if (schoolTrivia.currentQuestion >= schoolTrivia.totalQuestions || schoolTrivia.currentQuestion >= questions.length) {
                endSchoolTriviaGame();
                return;
            }
            
            const question = questions[schoolTrivia.currentQuestion];
            
            document.getElementById('school-question-text').textContent = question.question;
            
            const optionsContainer = document.getElementById('school-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'trivia-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectSchoolTriviaOption(index, optionDiv);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('school-submit').disabled = true;
            document.getElementById('school-next').disabled = true;
            schoolTrivia.selectedAnswer = null;
            
            updateSchoolTriviaDisplay();
        }

        function selectSchoolTriviaOption(index, element) {
            if (!gameState.schoolTrivia.gameActive) return;
            
            document.querySelectorAll('#school-options .trivia-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            element.classList.add('selected');
            gameState.schoolTrivia.selectedAnswer = index;
            document.getElementById('school-submit').disabled = false;
        }

        function submitSchoolTriviaAnswer() {
            if (gameState.schoolTrivia.selectedAnswer === null) return;
            
            const schoolTrivia = gameState.schoolTrivia;
            const questions = schoolTriviaQuestions[schoolTrivia.subject][schoolTrivia.grade];
            const question = questions[schoolTrivia.currentQuestion];
            const isCorrect = schoolTrivia.selectedAnswer === question.correct;
            
            // Show correct/incorrect styling
            const options = document.querySelectorAll('#school-options .trivia-option');
            options.forEach((opt, index) => {
                if (index === question.correct) {
                    opt.classList.add('correct');
                } else if (index === schoolTrivia.selectedAnswer && !isCorrect) {
                    opt.classList.add('incorrect');
                }
                opt.onclick = null; // Disable clicking
            });
            
            if (isCorrect) {
                schoolTrivia.correctAnswers++;
                const points = schoolTrivia.grade === 'high' ? 15 : schoolTrivia.grade === 'middle' ? 10 : 5;
                schoolTrivia.score += points;
                showFeedback('school', '‚úÖ Correct!', 'correct');
            } else {
                showFeedback('school', `‚ùå Incorrect. The correct answer was: ${question.options[question.correct]}`, 'incorrect');
            }
            
            schoolTrivia.currentQuestion++;
            document.getElementById('school-submit').disabled = true;
            document.getElementById('school-next').disabled = false;
            
            updateSchoolTriviaDisplay();
        }

        function nextSchoolTriviaQuestion() {
            showSchoolTriviaQuestion();
        }

        function endSchoolTriviaGame() {
            const schoolTrivia = gameState.schoolTrivia;
            schoolTrivia.gameActive = false;
            
            const percentage = Math.round((schoolTrivia.correctAnswers / schoolTrivia.totalQuestions) * 100);
            const won = percentage >= 70;
            
            document.getElementById('school-question-text').textContent = 'Quiz Complete!';
            document.getElementById('school-options').innerHTML = '';
            
            document.getElementById('school-game-over').innerHTML = `
                <div class="game-over ${won ? 'win' : 'lose'}">
                    <h3>${won ? 'üéì Excellent Work!' : 'üìö Keep Studying!'}</h3>
                    <p><strong>Subject:</strong> ${gameState.schoolTrivia.subject.charAt(0).toUpperCase() + gameState.schoolTrivia.subject.slice(1)}</p>
                    <p><strong>Grade Level:</strong> ${getGradeName(gameState.schoolTrivia.grade)}</p>
                    <p><strong>Score:</strong> ${schoolTrivia.score} points</p>
                    <p><strong>Correct:</strong> ${schoolTrivia.correctAnswers}/${schoolTrivia.totalQuestions} (${percentage}%)</p>
                    ${won ? '<p>Outstanding academic performance!</p>' : '<p>Try again to improve your score!</p>'}
                </div>
            `;
            
            document.getElementById('school-submit').disabled = true;
            document.getElementById('school-next').disabled = true;
            document.getElementById('school-start').disabled = false;
            
            addGameResult(won, schoolTrivia.score);
            updateSchoolTriviaDisplay();
        }

        function getGradeName(grade) {
            const names = {
                'elementary': 'K-4th Grade',
                'middle': '5th-8th Grade', 
                'high': 'High School'
            };
            return names[grade] || grade;
        }

        function updateSchoolTriviaDisplay() {
            const schoolTrivia = gameState.schoolTrivia;
            
            document.getElementById('school-question-num').textContent = `${schoolTrivia.currentQuestion}/${schoolTrivia.totalQuestions}`;
            document.getElementById('school-subject').textContent = schoolTrivia.subject.charAt(0).toUpperCase() + schoolTrivia.subject.slice(1);
            document.getElementById('school-grade').textContent = getGradeName(schoolTrivia.grade);
            document.getElementById('school-score').textContent = schoolTrivia.score;
        }

        // GEO GUESSER GAME
        function initGeoGuesserGame() {
            // Mode selectors
            document.querySelectorAll('[data-mode]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('[data-mode]').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    gameState.geoGuesser.mode = e.target.dataset.mode;
                    updateGeoGuesserDisplay();
                });
            });

            // Game buttons
            document.getElementById('geo-start').addEventListener('click', startGeoGuesserGame);
            document.getElementById('geo-submit-guess').addEventListener('click', submitGeoGuess);
            document.getElementById('geo-next').addEventListener('click', nextGeoLocation);
            document.getElementById('geo-skip').addEventListener('click', skipGeoLocation);

            updateGeoGuesserDisplay();
        }

        function startGeoGuesserGame() {
            const geoGuesser = gameState.geoGuesser;
            geoGuesser.currentRound = 0;
            geoGuesser.score = 0;
            geoGuesser.gameActive = true;

            document.getElementById('geo-start').disabled = true;
            showGeoLocation();
            updateGeoGuesserDisplay();
        }

        function showGeoLocation() {
            const geoGuesser = gameState.geoGuesser;
            const data = geoGuesserData[geoGuesser.mode];
            
            if (geoGuesser.currentRound >= geoGuesser.totalRounds) {
                endGeoGuesserGame();
                return;
            }
            
            const location = data[Math.floor(Math.random() * data.length)];
            geoGuesser.currentLocation = location;
            
            // Display location hint and image placeholder
            if (geoGuesser.mode === 'world') {
                document.getElementById('geo-location-hint').textContent = location.hint;
            } else if (geoGuesser.mode === 'usStates') {
                document.getElementById('geo-location-hint').textContent = `Nickname: ${location.nickname} | Region: ${location.region}`;
            } else if (geoGuesser.mode === 'continents') {
                document.getElementById('geo-location-hint').textContent = `Countries: ${location.countries.slice(0, 3).join(', ')}...`;
            }
            
            document.getElementById('geo-guess-input').value = '';
            document.getElementById('geo-submit-guess').disabled = false;
            document.getElementById('geo-next').disabled = true;
            
            updateGeoGuesserDisplay();
        }

        function submitGeoGuess() {
            const geoGuesser = gameState.geoGuesser;
            const guess = document.getElementById('geo-guess-input').value.trim().toLowerCase();
            
            if (!guess) return;
            
            geoGuesser.guessedLocation = guess;
            const location = geoGuesser.currentLocation;
            let isCorrect = false;
            let distance = 0;
            
            if (geoGuesser.mode === 'world') {
                isCorrect = guess.includes(location.country.toLowerCase()) || 
                           guess.includes(location.city.toLowerCase()) ||
                           guess.includes(location.name.toLowerCase());
                distance = calculateDistance(guess, location);
            } else if (geoGuesser.mode === 'usStates') {
                isCorrect = guess.includes(location.name.toLowerCase()) ||
                           guess.includes(location.capital.toLowerCase());
                distance = isCorrect ? 0 : Math.random() * 1000; // Simulated distance
            } else if (geoGuesser.mode === 'continents') {
                isCorrect = guess.includes(location.name.toLowerCase());
                distance = isCorrect ? 0 : Math.random() * 5000; // Simulated distance
            }
            
            geoGuesser.distance = distance;
            geoGuesser.accuracy = Math.max(0, 100 - (distance / 100));
            
            if (isCorrect) {
                const points = Math.round(Math.max(10, 100 - distance / 10));
                geoGuesser.score += points;
                showFeedback('geo', `üéØ Correct! +${points} points`, 'correct');
            } else {
                showFeedback('geo', `‚ùå Incorrect. It was: ${getLocationName(location)}`, 'incorrect');
            }
            
            geoGuesser.currentRound++;
            document.getElementById('geo-submit-guess').disabled = true;
            document.getElementById('geo-next').disabled = false;
            
            updateGeoGuesserDisplay();
        }

        function getLocationName(location) {
            if (gameState.geoGuesser.mode === 'world') {
                return `${location.name}, ${location.country}`;
            } else if (gameState.geoGuesser.mode === 'usStates') {
                return `${location.name} (Capital: ${location.capital})`;
            } else {
                return location.name;
            }
        }

        function calculateDistance(guess, location) {
            // Simplified distance calculation - in a real app you'd use actual coordinates
            return Math.random() * 500;
        }

        function nextGeoLocation() {
            showGeoLocation();
        }

        function skipGeoLocation() {
            geoGuesser.currentRound++;
            showGeoLocation();
        }

        function endGeoGuesserGame() {
            const geoGuesser = gameState.geoGuesser;
            geoGuesser.gameActive = false;
            
            const avgAccuracy = geoGuesser.score / geoGuesser.totalRounds;
            const won = avgAccuracy >= 50;
            
            document.getElementById('geo-location-hint').textContent = 'Game Complete!';
            
            document.getElementById('geo-game-over').innerHTML = `
                <div class="game-over ${won ? 'win' : 'lose'}">
                    <h3>${won ? 'üåç Geography Expert!' : 'üó∫Ô∏è Keep Exploring!'}</h3>
                    <p><strong>Mode:</strong> ${getModeDisplayName(geoGuesser.mode)}</p>
                    <p><strong>Total Score:</strong> ${geoGuesser.score} points</p>
                    <p><strong>Average Accuracy:</strong> ${avgAccuracy.toFixed(1)}%</p>
                    <p><strong>Rounds Completed:</strong> ${geoGuesser.totalRounds}</p>
                    ${won ? '<p>Outstanding geographical knowledge!</p>' : '<p>Try again to improve your score!</p>'}
                </div>
            `;
            
            document.getElementById('geo-submit-guess').disabled = true;
            document.getElementById('geo-next').disabled = true;
            document.getElementById('geo-start').disabled = false;
            
            addGameResult(won, geoGuesser.score);
            updateGeoGuesserDisplay();
        }

        function getModeDisplayName(mode) {
            const names = {
                'world': 'World Locations',
                'usStates': 'US States',
                'continents': 'Continents'
            };
            return names[mode] || mode;
        }

        function updateGeoGuesserDisplay() {
            const geoGuesser = gameState.geoGuesser;
            
            document.getElementById('geo-round').textContent = `${geoGuesser.currentRound + 1}/${geoGuesser.totalRounds}`;
            document.getElementById('geo-score').textContent = geoGuesser.score;
            document.getElementById('geo-distance').textContent = geoGuesser.distance ? `${geoGuesser.distance.toFixed(1)} km` : '-';
            document.getElementById('geo-accuracy').textContent = geoGuesser.accuracy ? `${geoGuesser.accuracy.toFixed(1)}%` : '-';
        }

        window.addEventListener('DOMContentLoaded', () => {
            loadUserStats();
            initRiddlesGame();
            initBurbleGame();
            initEmojiGame();
            initValentineGame();
            initTriviaGame();
            initAnimalTriviaGame();
            initAudioManager();
            initSchoolTriviaGame();
            initGeoGuesserGame();
            updateUserStats();
        });
    </script>
</body>
</html>